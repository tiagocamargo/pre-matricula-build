import{q as re,a as K,o as ee,_ as N,X as ue,c as ce,n as Se,t as Te,m as $e,e as M,b as Ce,v as Re,w as we,x as Ae,y as ke}from"./common.c7e4875a.js";import{d as H,r as y,M as W,g as B,o as l,c as m,a as e,t as f,F as Q,z as Z,q as u,B as g,D as z,ad as Ie,ae as Pe,a5 as L,a7 as se,v,A as $,_ as Ne,O as te,G as Le,I as Ve,f as Oe,u as De}from"./vendor.c0962c27.js";import{p as Me,l as Fe,a as Ue,b as Be}from"./shared/prepregistrations-subscription/preregistrations.efb8d1a0.js";import{R as ze,S as He}from"./shared/prepregistrations-subscription/processes.15a71db5.js";import"./geolib.eaab1de8.js";const R=o=>(Ie("data-v-8470e47d"),o=o(),Pe(),o),qe={class:"container-pmd"},Ge=R(()=>e("h2",{class:"font-muli-20-primary mb-4 text-center"}," Sua inscri\xE7\xE3o foi realizada com sucesso! ",-1)),je=R(()=>e("p",{class:"mb-4"},[L(" Para acompanhar a atualiza\xE7\xE3o da Pr\xE9-matr\xEDcula, n\xE3o esque\xE7a de anotar/salvar o(s) c\xF3digo(s) do(s) "),e("strong",null,"protocolo(s)"),L(" gerado(s). ")],-1)),We={class:"m-auto",style:{"max-width":"340px"}},Xe={key:0,class:"font-weight-bold"},Je={key:1,class:"font-weight-bold"},Ye={key:0},Ke=R(()=>e("div",{class:"alert badge-yellow text-center text-uppercase"}," Lista de espera ",-1)),Qe=[Ke],Ze={key:1},es=R(()=>e("div",{class:"alert badge-blue text-center text-uppercase"}," Pr\xE9-matr\xEDcula ",-1)),ss=[es],ts={class:"pull-right text-right",style:{width:"120px",height:"90px"}},os=["src","alt"],as={class:"mb-0"},ls=R(()=>e("dt",{class:"mt-3"},"C\xF3digo do protocolo",-1)),ns={class:"font-hind-18-primary font-weight-bold"},ds=R(()=>e("dt",{class:"mt-3"},"Data da solicita\xE7\xE3o",-1)),is=R(()=>e("dt",{class:"mt-3"},"Nome do(a) aluno(a)",-1)),rs=R(()=>e("dt",{class:"mt-3"},"S\xE9rie/Turno",-1)),us=R(()=>e("dt",{class:"mt-3"},"Escola",-1)),cs={class:"mb-0"},ms={key:0,class:"mb-0"},ps={class:"text-muted text-size-10 mt-4"},vs=R(()=>e("span",{class:"text-uppercase"},"C\xF3digo de autenticidade:",-1)),fs=R(()=>e("br",null,null,-1)),bs={class:"text-dark"},_s=["innerHTML"],hs={class:"text-center mt-5 mb-4"},Es={class:"row mb-5"},ys={class:"col-12 col-md-4 offset-md-2"},gs={class:"col-12 col-md-4"},xs={class:"row"},Ss={class:"col-12 col-md-5 offset-md-1 mb-4"},Ts={class:"col-12 col-md-5 mb-4"},$s=R(()=>e("p",null," Preencha o campo abaixo com o e-mail que deve receber o(s) protocolo(s): ",-1)),Cs=H({__name:"Protocol",props:{preregistrations:null,process:null,student:null,responsible:null},emits:["finish"],setup(o,{emit:S}){const C=o,d=se("$filters"),{dialog:b}=re(),{loader:w,loading:p}=K(),h=ee(),A=y(),I=y({email:!1}),O=W(C,"process"),V=B(()=>({fields:[{type:"EMAIL",label:"",name:"email",rules:"required|email",containerClass:"col-12"}],buttons:[{type:"submit",label:"Prosseguir",class:"btn btn-block btn-primary",containerClass:"mt-3",block:!0}],buttonsContainer:{class:""}})),D=k=>{var E;return(E=O.value.grades.find(t=>Number(t.id)===Number(k)))==null?void 0:E.name},P=k=>{var E;return(E=O.value.periods.find(t=>Number(t.id)===Number(k)))==null?void 0:E.name},_=()=>{window.print()},n=()=>{I.value.email=!0,A.value=C.responsible.responsible_email},s=k=>{w(()=>Me({email:k.email,preregistrations:C.preregistrations.map(E=>E.id)})).then(E=>{E?I.value.email=!1:b({title:"Erro!",description:"N\xE3o foi poss\xEDvel enviar o e-mail.",iconLeft:"status-left",titleClass:"danger"})})},i=()=>{S("finish")};return(k,E)=>(l(),m("div",qe,[Ge,je,e("div",We,[o.preregistrations.length===1?(l(),m("p",Xe," Seu protocolo: ")):f("",!0),o.preregistrations.length>1?(l(),m("p",Je," Seus protocolos: ")):f("",!0),(l(!0),m(Q,null,Z(o.preregistrations,t=>(l(),m("div",{key:t.id,class:"mt-4"},[g($e,{bordered:"",class:"protocol m-auto"},{default:z(()=>[g(Se,null,{default:z(()=>[t.type==="WAITING_LIST"?(l(),m("div",Ye,Qe)):(l(),m("div",Ze,ss)),e("div",ts,[e("img",{src:u(h).logo,alt:u(h).entity.city,height:"90"},null,8,os)]),e("dl",as,[ls,e("dd",ns," #"+v(t.protocol),1),o.process.showPriorityProtocol?(l(),$(Te,{key:0,preregistration:t},null,8,["preregistration"])):f("",!0),ds,e("dd",null,v(u(d).formatDateTime(t.date)),1),is,e("dd",null,v(o.student.student_name),1),rs,e("dd",null,v(D(o.student.grade))+" / "+v(P(o.student.period)),1),us,e("dd",null,[e("p",cs,v(t.school.name),1),t.school.phone?(l(),m("p",ms," Telefone: "+v(`(${t.school.area_code}) ${t.school.phone}`),1)):f("",!0)])]),e("div",ps,[vs,fs,e("span",bs,v(t.code),1)])]),_:2},1024)]),_:2},1024)]))),128))]),e("div",{class:"mt-5 text-center",innerHTML:u(O).messageFooter},null,8,_s),e("div",hs,[e("div",Es,[e("div",ys,[g(N,{color:"primary",outline:"",label:"Imprimir",class:"w-100 mb-2",size:"lg","no-caps":"","no-wrap":"",onClick:_})]),e("div",gs,[g(N,{color:"primary",outline:"",label:"Enviar por e-mail",class:"w-100",size:"lg","no-caps":"","no-wrap":"",onClick:n})])]),e("div",xs,[e("div",Ss,[g(N,{color:"primary",label:"Nova Inscri\xE7\xE3o",outline:"",class:"w-100",size:"lg","no-caps":"","no-wrap":"",onClick:i})]),e("div",Ts,[g(N,{color:"primary",label:"Voltar para a tela inicial",class:"w-100 border-primary",size:"lg","no-caps":"","no-wrap":"",onClick:E[0]||(E[0]=t=>k.$router.push("/"))})])])]),g(ce,{modelValue:I.value.email,"onUpdate:modelValue":E[1]||(E[1]=t=>I.value.email=t),title:"Enviar protocolo(s) por e-mail","no-footer":""},{body:z(()=>[$s,g(ue,{schema:u(V),loading:u(p),onSubmit:s},null,8,["schema","loading"])]),_:1},8,["modelValue"])]))}});const Rs=Ne(Cs,[["__scopeId","data-v-8470e47d"]]),ws=e("h2",{class:"font-muli-20-primary mb-4"}," Identifique o(a) aluno(a) para continuar com a inscri\xE7\xE3o: ",-1),As=e("p",null,[L(" Preencha os dados abaixo para identificar o(a) "),e("strong",null,"aluno(a)"),L(" que ser\xE1 rematriculado(a). ")],-1),ks={key:0,class:"row mt-5"},Is=L(" Confirme se as iniciais do nome e a data de nascimento do(a) aluno(a) est\xE3o corretas: "),Ps={key:0,class:"mt-4"},Ns={class:"row"},Ls={class:"col"},Vs=e("dt",{class:"font-hind font-size-10"},"Iniciais",-1),Os={class:"col"},Ds=e("dt",{class:"font-hind font-size-10"},"Data de nascimento",-1),Ms={class:"row"},Fs={class:"col-6"},Us={class:"col-6"},Bs=H({__name:"RegistrationMatch",props:{student:null,registrationType:null,errors:null,openMatch:{type:Boolean}},emits:["next"],setup(o){const S=o,C=se("$filters"),d=W(S,"openMatch"),b=W(S,"student");return(w,p)=>(l(),m("div",null,[ws,As,o.registrationType?(l(),m("div",ks,[o.registrationType==="NAME_DATE_OF_BIRTH"?(l(),$(M,{key:0,modelValue:u(b).student_name,"onUpdate:modelValue":p[0]||(p[0]=h=>u(b).student_name=h),"container-class":"col-12 col-md-6",label:"Nome do(a) aluno(a)",name:"student_name",rules:"required",type:"TEXT",errors:!!o.errors.student_name},null,8,["modelValue","errors"])):f("",!0),o.registrationType==="NAME_DATE_OF_BIRTH"?(l(),$(M,{key:1,modelValue:u(b).student_date_of_birth,"onUpdate:modelValue":p[1]||(p[1]=h=>u(b).student_date_of_birth=h),"container-class":"col-12 col-md-6",label:"Data de nascimento do(a) aluno(a)",name:"student_date_of_birth",rules:"required|date",type:"DATE",errors:!!o.errors.student_date_of_birth},null,8,["modelValue","errors"])):f("",!0),o.registrationType==="CPF"?(l(),$(M,{key:2,modelValue:u(b).student_cpf,"onUpdate:modelValue":p[2]||(p[2]=h=>u(b).student_cpf=h),"container-class":"col-12 col-md-6 offset-md-3",label:"CPF do(a) aluno(a)",name:"student_cpf",rules:"required|cpf",type:"CPF",errors:!!o.errors.student_cpf},null,8,["modelValue","errors"])):f("",!0),o.registrationType==="RG"?(l(),$(M,{key:3,modelValue:u(b).student_rg,"onUpdate:modelValue":p[3]||(p[3]=h=>u(b).student_rg=h),"container-class":"col-12 col-md-6 offset-md-3",label:"RG do(a) aluno(a)",name:"student_rg",rules:"required",type:"RG",errors:!!o.errors.student_rg},null,8,["modelValue","errors"])):f("",!0),o.registrationType==="BIRTH_CERTIFICATE"?(l(),$(M,{key:4,modelValue:u(b).student_birth_certificate,"onUpdate:modelValue":p[4]||(p[4]=h=>u(b).student_birth_certificate=h),"container-class":"col-12 col-md-8 offset-md-2",label:"Certid\xE3o de Nascimento do(a) aluno(a)",name:"student_birth_certificate",rules:"required",type:"BIRTH_CERTIFICATE",errors:!!o.errors.student_birth_certificate},null,8,["modelValue","errors"])):f("",!0)])):f("",!0),g(ce,{modelValue:u(d),"onUpdate:modelValue":p[7]||(p[7]=h=>te(d)?d.value=h:null),"icon-left":"status-green",title:"Aluno(a) Encontrado(a)","no-footer":""},{body:z(()=>[Is,u(b).match?(l(),m("div",Ps,[e("div",Ns,[e("dl",Ls,[Vs,e("dd",null,v(u(b).match.initials),1)]),e("dl",Os,[Ds,e("dd",null,v(u(C).formatDate(u(b).match.dateOfBirth)),1)])])])):f("",!0),e("div",Ms,[e("div",Fs,[g(N,{label:"N\xE3o s\xE3o estas",color:"gray-500",outline:"",class:"w-100","no-caps":"","no-wrap":"",onClick:p[5]||(p[5]=h=>d.value=!1)})]),e("div",Us,[g(N,{label:"Est\xE3o corretas",color:"primary",class:"border-primary w-100","no-caps":"","no-wrap":"",onClick:p[6]||(p[6]=h=>w.$emit("next"))})])])]),_:1},8,["modelValue"])]))}}),zs=e("h2",{class:"font-muli-20-primary mb-4"}," Identifique o(a) aluno(a) para continuar com a inscri\xE7\xE3o: ",-1),Hs=e("p",null,[L(" Selecione uma das op\xE7\xF5es abaixo para validar se o(a) "),e("strong",null,"aluno(a)"),L(" j\xE1 est\xE1 vinculado a rede municipal de ensino. Caso n\xE3o seja poss\xEDvel identific\xE1-lo com a op\xE7\xE3o selecionada, voc\xEA pode escolher outro campo para validar a exist\xEAncia dos dados. A solicita\xE7\xE3o de "),e("strong",null,"rematr\xEDcula"),L(" poder\xE1 ser efetuada somente para "),e("strong",null,"alunos(as) que estudaram no ano anterior na rede municipal"),L(". ")],-1),qs={class:"mt-5"},Gs=H({__name:"RegistrationPreMatch",props:{modelValue:null,errors:null,rules:null},setup(o){const S=o,C=y([{key:"CPF",label:"CPF do(a) aluno(a)"},{key:"RG",label:"RG do(a) aluno(a)"},{key:"BIRTH_CERTIFICATE",label:"Certid\xE3o de nascimento do(a) aluno(a)"},{key:"NAME_DATE_OF_BIRTH",label:"Nome e data de nascimento do(a) aluno(a)"}]),d=W(S,"modelValue");return(b,w)=>(l(),m("div",null,[zs,Hs,e("div",qs,[g(M,{modelValue:u(d),"onUpdate:modelValue":w[0]||(w[0]=p=>te(d)?d.value=p:null),"container-class":"col-12 m-0 p-0 registration_custom",name:"type",rules:o.rules,type:"PRETTY_RADIO",options:C.value,errors:!!o.errors.type},null,8,["modelValue","rules","options","errors"])])]))}}),js={class:"container-pmd"},Ws=e("h2",{class:"font-muli-20-primary mb-4"}," Confira seus dados antes de finalizar a inscri\xE7\xE3o: ",-1),Xs={class:"mb-3 d-sm-flex justify-content-between"},Js=e("h3",{class:"font-hind-18-primary"}," Dados do(a) respons\xE1vel pelo(a) aluno(a) ",-1),Ys={class:"row"},Ks={class:"font-hind font-size-10"},Qs={key:0},Zs={key:1},et={class:"col-6"},st=e("dt",{class:"font-hind font-size-10"},"Rela\xE7\xE3o com o(a) aluno(a)",-1),tt={class:"col-sm-12"},ot=e("dt",{class:"font-hind font-size-10"},"Endere\xE7o",-1),at={key:0,class:"col-sm-12"},lt=e("dt",{class:"font-hind font-size-10"},"Endere\xE7o secund\xE1rio",-1),nt={class:"mt-5 mb-3 d-sm-flex justify-content-between"},dt=e("h3",{class:"font-hind-18-primary"},"Dados do(a) aluno(a)",-1),it={class:"row"},rt={class:"font-hind font-size-10"},ut={key:0},ct={key:1},mt={class:"mt-5 mb-3 d-sm-flex justify-content-between"},pt=e("h3",{class:"font-hind-18-primary"},"Dados da pr\xE9-matr\xEDcula",-1),vt={class:"row"},ft={class:"col-6"},bt=e("dt",{class:"font-hind font-size-10"},"S\xE9rie",-1),_t={class:"col-6"},ht=e("dt",{class:"font-hind font-size-10"},"Turno",-1),Et={key:0,class:"col-sm-12"},yt=e("dt",{class:"font-hind font-size-10"},"Escola",-1),gt={key:1,class:"col-sm-12"},xt=e("dt",{class:"font-hind font-size-10"},"Escola (lista de espera)",-1),St={class:"row"},Tt=H({__name:"Review",props:{errors:null,fields:{default:()=>({})},responsible:{default:()=>({})},student:{default:()=>({})},process:{default:()=>({})}},emits:["edit-student","edit-responsible"],setup(o){const S=o,C=se("$filters"),d=ee(),b=y(!1),w=B(()=>d.getCities),p=B(()=>C.joinAddress(S.responsible.address)),h=B(()=>C.joinAddress(S.responsible.secondAddress)),A=_=>{var n;return(n=d.relationTypes.find(s=>s.key===_))==null?void 0:n.label},I=_=>{var n;return(n=S.process.grades.find(s=>Number(s.id)===Number(_)))==null?void 0:n.name},O=_=>{var n;return(n=S.process.periods.find(s=>Number(s.id)===Number(_)))==null?void 0:n.name},V=_=>{var n;return(n=S.process.schools.find(s=>Number(s.id)===Number(_)))==null?void 0:n.name},D=(_,n)=>{var s;return _[n.key]?(s=w.value.find(i=>i.key==_[n.key]))==null?void 0:s.label:"-"},P=(_,n)=>n.filter(_[n.key]);return(_,n)=>(l(),m("div",js,[Ws,e("div",Xs,[Js,g(N,{"data-test":"btn-edit-responsible",color:"primary",outline:"",class:"flex-row",label:"Editar dados","no-caps":"","no-wrap":"",onClick:n[0]||(n[0]=s=>_.$emit("edit-responsible"))})]),e("div",Ys,[(l(!0),m(Q,null,Z(o.fields.responsible,s=>(l(),m("dl",{key:s.id,class:"col-6"},[e("dt",Ks,v(s.field.name),1),s.type!=="CITY"?(l(),m("dd",Qs,v(P(o.responsible,s)),1)):(l(),m("dd",Zs,v(D(o.responsible,s)),1))]))),128)),e("dl",et,[st,e("dd",null,v(A(o.responsible.relationType)),1)]),e("dl",tt,[ot,e("dd",null,v(u(p)),1)]),o.responsible.secondAddress&&o.responsible.secondAddress.postalCode?(l(),m("dl",at,[lt,e("dd",null,v(u(h)),1)])):f("",!0)]),e("div",nt,[dt,g(N,{"data-test":"btn-edit-student",color:"primary",outline:"",class:"flex-row",label:"Editar dados","no-caps":"","no-wrap":"",onClick:n[1]||(n[1]=s=>_.$emit("edit-student"))})]),e("div",it,[(l(!0),m(Q,null,Z(o.fields.student,s=>(l(),m("dl",{key:s.id,class:"col-6"},[e("dt",rt,v(s.field.name),1),s.type!=="CITY"?(l(),m("dd",ut,v(P(o.student,s)),1)):(l(),m("dd",ct,v(D(o.student,s)),1))]))),128))]),e("div",mt,[pt,g(N,{"data-test":"btn-edit-student-2",color:"primary",outline:"",class:"flex-row",label:"Editar dados","no-caps":"","no-wrap":"",onClick:n[2]||(n[2]=s=>_.$emit("edit-student"))})]),e("div",vt,[e("dl",ft,[bt,e("dd",null,v(I(o.student.grade)),1)]),e("dl",_t,[ht,e("dd",null,v(O(o.student.period)),1)]),o.student.school?(l(),m("dl",Et,[yt,e("dd",null,v(V(o.student.school)),1)])):f("",!0),o.student.secondSchool?(l(),m("dl",gt,[xt,e("dd",null,v(V(o.student.secondSchool)),1)])):f("",!0)]),e("div",St,[g(M,{modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=s=>b.value=s),label:`
        Eu autorizo o uso e tratamento dos dados pessoais acima para fins destinados a pr\xE9-matr\xEDcula na rede municipal
        `,"container-class":"col-12 col-md-8 offset-md-2 mt-4",rules:"required",errors:Boolean(o.errors.accept),name:"accept",type:"CHECKBOX"},null,8,["modelValue","errors"])])]))}}),$t={class:"mt-5"},Ct={class:"col-12"},Rt={key:5,class:"text-danger col-6 offset-3 text-center mt-5 alert alert-danger"},Nt=H({__name:"PreRegistration",setup(o){const{dialog:S}=re(),{loader:C,data:d}=K(),{loader:b,loading:w}=K(),{loader:p,loading:h}=Ce(),{page:A}=Re(),I=ee(),O=Oe(),V=De(),D=y(),P=y(null),_=y([]),n=y({responsible:[],student:[]}),s=y({}),i=y({}),k=y({}),E=y({}),t=y("LOADING"),oe=y({}),X=y(0),J=y(!1),Y=y(!1),q=y(!1),me=B(()=>({fields:[],buttons:[{type:"button",label:"Voltar",class:"btn btn-block btn-outline-light",containerClass:"offset-md-3 col-md-3",block:!0,action:fe},{type:"submit",label:"Prosseguir",class:"btn btn-block btn-primary",containerClass:"col-md-3 mt-3 mt-md-0",block:!0}],buttonsContainer:{class:"row mt-5"}}));Le(t,c=>{c==="PRE_MATCH"?A({path:"/inscricao/dados-do-aluno"}):c==="MATCH"?A({path:"/inscricao/dados-do-aluno"}):c==="RESPONSIBLE"?A({path:"/inscricao/dados-do-responsavel"}):c==="STUDENT"?A({path:"/inscricao/dados-do-aluno"}):c==="REVIEW"?A({path:"/inscricao/conferencia-de-dados"}):c==="PROTOCOL"&&A({path:"/inscricao/protocolo"})});const pe=()=>{C(()=>Fe({id:O.params.id})).then(c=>{if(c.status!=="OPEN"){V.push("/");return}d.value=c;const{fields:a,data:T}=we(d.value.process),{fields:U,data:r}=Ae(d.value.process);if(n.value.responsible=a.sortBy("order"),s.value=T,n.value.student=U.sortBy("order"),i.value=r,!I.isProduction){const G=window.localStorage.getItem("responsible"),j=window.localStorage.getItem("student");G&&(s.value={...T,...JSON.parse(G)}),j&&(i.value={...r,...JSON.parse(j),useSecondSchool:!1})}k.value={...T},E.value={...r},t.value=d.value.type==="REGISTRATION_RENEWAL"?"PRE_MATCH":"RESPONSIBLE"})},ve=()=>{var c;t.value=((c=d.value)==null?void 0:c.type)==="REGISTRATION_RENEWAL"?"PRE_MATCH":"RESPONSIBLE",oe.value=s.value,i.value={...E.value}},fe=()=>{t.value==="PRE_MATCH"?V.back():t.value==="MATCH"?t.value="PRE_MATCH":t.value==="RESPONSIBLE"?V.back():t.value==="STUDENT"?t.value="RESPONSIBLE":t.value==="REVIEW"&&(t.value="STUDENT"),window.scrollTo(0,0)},be=async c=>{if(t.value==="PRE_MATCH")t.value="MATCH";else if(t.value==="MATCH")await F.submitMatch();else if(t.value==="RESPONSIBLE"){if(!c.address.lat&&!c.address.lng||c.address.lat===0&&c.address.lng===0)return;s.value={...s.value,...c},F.saveOnStorage(),t.value="STUDENT"}else t.value==="STUDENT"?(i.value={...i.value,...c},F.saveOnStorage(),F.submitToReview()):t.value==="REVIEW"&&await F.submit();window.scrollTo(0,0)},_e=async()=>{b(()=>Ue({type:P.value,student:i.value,year:d.value.process.schoolYear.year})).then(c=>{i.value.match=c,i.value.match!==null?q.value=!0:(q.value=!1,S({title:"Aluno(a) n\xE3o encontrado(a)",titleClass:"danger",description:"Verifique se os dados informados est\xE3o corretos. Caso n\xE3o encontre nenhum resultado, clique em 'Voltar' e efetue a valida\xE7\xE3o com outro tipo de dado."}))})},he=async()=>{var ae,le,ne,de,ie;const{grade:c,period:a,school:T}=i.value,U=Object.keys(s.value).filter(x=>x.substring(0,6)==="field_"||x.substring(0,12)==="responsible_").map(x=>({field:x,value:s.value[x]?String(s.value[x]):null})),r=Object.keys(i.value).filter(x=>x.substring(0,6)==="field_"||x.substring(0,8)==="student_").map(x=>({field:x,value:i.value[x]?String(i.value[x]):null})),G=i.value.useSecondSchool||((ae=d.value)==null?void 0:ae.type)==="WAITING_LIST"?i.value.secondSchool:null,j=i.value.useSecondSchool||((le=d.value)==null?void 0:le.type)==="WAITING_LIST"?i.value.secondPeriod:null;s.value.address.manualChangeLocation||(s.value.address.manualChangeLocation=!1),s.value.useSecondAddress&&!s.value.secondAddress.manualChangeLocation&&(s.value.secondAddress.manualChangeLocation=!1);const xe={process:(ne=d.value)==null?void 0:ne.process.id,stage:(de=d.value)==null?void 0:de.id,type:(ie=d.value)==null?void 0:ie.type,grade:c,period:a,school:T,optionalSchool:G,optionalPeriod:j||a,address:s.value.address,optionalAddress:s.value.useSecondAddress?s.value.secondAddress:null,relationType:s.value.relationType,responsible:U,student:r,externalPerson:i.value.match?i.value.match.id:null};p(()=>Be(xe)).then(x=>{_.value=x.preregistrations,t.value="PROTOCOL"})},Ee=()=>{if(s.value.responsible_cpf&&i.value.student_cpf&&s.value.responsible_cpf===i.value.student_cpf&&s.value.relationType!=="SELF"){D.value.$refs.form.setErrors({student_cpf:"CPF igual ao do respons\xE1vel"});return}t.value="REVIEW"},ye=()=>{I.isProduction||setInterval(()=>{window.localStorage.setItem("responsible",JSON.stringify(s.value)),window.localStorage.setItem("student",JSON.stringify(i.value))},5e3)},ge=({changed:c,secondAddress:a})=>{s.value[a?"secondAddress":"address"].manualChangeLocation=c};Ve(()=>pe());const F={submitMatch:_e,saveOnStorage:ye,submitToReview:Ee,submit:he};return F.saveOnStorage(),(c,a)=>(l(),m("div",$t,[t.value==="LOADING"?(l(),$(ke,{key:0})):f("",!0),t.value!=="LOADING"&&t.value!=="PROTOCOL"?(l(),$(ue,{ref_key:"form",ref:D,key:X.value+"-force-renderer","disable-proceed":J.value||Y.value,schema:u(me),loading:u(w)||u(h),"initial-values":oe.value,onSubmit:be},{default:z(({errors:T,setFieldValue:U})=>[e("div",Ct,[t.value==="PRE_MATCH"?(l(),$(Gs,{key:0,modelValue:P.value,"onUpdate:modelValue":a[0]||(a[0]=r=>P.value=r),rules:"required",errors:T,class:"container-pmd"},null,8,["modelValue","errors"])):f("",!0),t.value==="MATCH"?(l(),$(Bs,{key:1,student:i.value,"onUpdate:student":a[1]||(a[1]=r=>i.value=r),"open-match":q.value,"onUpdate:open-match":a[2]||(a[2]=r=>q.value=r),"registration-type":P.value,errors:T,class:"container-pmd",onNext:a[3]||(a[3]=r=>t.value="RESPONSIBLE")},null,8,["student","open-match","registration-type","errors"])):f("",!0),t.value==="RESPONSIBLE"?(l(),$(ze,{key:2,fields:n.value.responsible,"onUpdate:fields":a[4]||(a[4]=r=>n.value.responsible=r),responsible:s.value,"onUpdate:responsible":a[5]||(a[5]=r=>s.value=r),fetchingPrimaryAddressLatLng:J.value,"onUpdate:fetchingPrimaryAddressLatLng":a[6]||(a[6]=r=>J.value=r),fetchingSecondaryAddressLatLng:Y.value,"onUpdate:fetchingSecondaryAddressLatLng":a[7]||(a[7]=r=>Y.value=r),errors:T,"set-field-value":U,class:"container-pmd",onClean:a[8]||(a[8]=r=>(s.value={...k.value},X.value+=1))},null,8,["fields","responsible","fetchingPrimaryAddressLatLng","fetchingSecondaryAddressLatLng","errors","set-field-value"])):f("",!0),t.value==="STUDENT"?(l(),$(He,{key:3,stage:u(d),"onUpdate:stage":a[9]||(a[9]=r=>te(d)?d.value=r:null),fields:n.value.student,"onUpdate:fields":a[10]||(a[10]=r=>n.value.student=r),student:i.value,"onUpdate:student":a[11]||(a[11]=r=>i.value=r),responsible:s.value,"onUpdate:responsible":a[12]||(a[12]=r=>s.value=r),errors:T,class:"container-pmd",onClean:a[13]||(a[13]=r=>(i.value={...E.value},X.value+=1)),onChangePrimaryAddress:ge},null,8,["stage","fields","student","responsible","errors"])):f("",!0),t.value==="REVIEW"?(l(),$(Tt,{key:4,process:u(d).process,fields:n.value,responsible:s.value,student:i.value,errors:T,onEditResponsible:a[14]||(a[14]=r=>t.value="RESPONSIBLE"),onEditStudent:a[15]||(a[15]=r=>t.value="STUDENT")},null,8,["process","fields","responsible","student","errors"])):f("",!0),Object.keys(T).length>0?(l(),m("div",Rt," Preencha todos os campos corretamente ")):f("",!0)])]),_:1},8,["disable-proceed","schema","loading","initial-values"])):f("",!0),u(d)&&t.value==="PROTOCOL"?(l(),$(Rs,{key:2,process:u(d).process,"onUpdate:process":a[16]||(a[16]=T=>u(d).process=T),preregistrations:_.value,responsible:s.value,student:i.value,onFinish:ve},null,8,["process","preregistrations","responsible","student"])):f("",!0)]))}});export{Nt as default};
