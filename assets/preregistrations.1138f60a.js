import{d as Ae,r as d,M as We,g as w,I as Me,o as a,A as U,D as J,c as r,a as e,t as c,B as f,q as s,w as Z,U as _e,v as n,O as Ge,a5 as ee,G as fe,$ as He,a3 as De,F as ne,z as ve,V as Je,u as Pe,f as je,x as qe,C as re,a7 as Ye}from"./vendor.c0962c27.js";import{u as ie,a as q,e as P,_ as S,c as Ve,q as Xe,b as Ke,o as Be,z as Qe,n as Ze,m as eo,A as oo,B as Ie,C as to,D as so,E as Ne,F as lo,G as he,w as ao,x as no}from"./common.c7e4875a.js";import{g as Ue,c as ro,d as io,e as co,f as uo,t as mo,h as po,i as vo,j as ho,k as _o,m as fo,n as go,o as Eo}from"./shared/prepregistrations-subscription/preregistrations.efb8d1a0.js";const bo={key:0},yo={class:"m-auto",style:{"max-width":"740px"}},xo={key:0,class:"mt-4 text-danger font-weight-bold"},wo=ee(" Tem certeza que deseja indeferir as pr\xE9-matr\xEDculas? "),To=e("hr",null,null,-1),Co=[wo,To],$o={key:1,class:"mt-4 font-weight-bold"},ko=ee(" Selecione a turma que deseja matricular os(as) alunos(as) para completar o deferimento das pr\xE9-matr\xEDculas dos(as) alunos(as). "),So=e("hr",null,null,-1),Ro={key:2,class:"mt-4 font-weight-bold"},No=ee(" Tem certeza que deseja convocar os respons\xE1veis desta(s) pr\xE9-matr\xEDcula(s)? "),Ao=e("hr",null,null,-1),Vo=[No,Ao],Do={key:3,class:"form-group"},Io=e("label",{class:"form-label"},"Observa\xE7\xF5es (opcional)",-1),Oo={key:4,class:"form-group"},Mo=e("label",{class:"form-label"},"Justificativa (opcional)",-1),Po={key:5},jo={class:"text-danger"},Bo=["innerHTML"],Uo={class:"d-flex justify-content-center mt-4"},Lo={key:1},zo={key:2},Fo={key:0,class:"mt-4 font-weight-bold"},Wo={key:1,class:"mt-4 font-weight-bold"},Go={key:2,class:"mt-4 font-weight-bold"},Ho={key:3,class:"mt-4"},Jo={class:"text-danger"},qo=["innerHTML"],Yo={class:"row justify-content-center d-flex mt-4"},Xo=Ae({__name:"PreRegistrationBatch",props:{filter:null,preregistrations:null,step:null,processYear:null,modelValue:{type:Boolean}},emits:["load"],setup(x,{emit:W}){const R=x,{loader:G}=ie(),{loader:Y}=ie(),{loader:L}=ie(),{loader:H,data:$}=q(),k=d(""),z=d(),V=d(!1),l=d(!1),A=d(),D=d(),y=d(!1),N=d(0),T=We(R,"modelValue"),C=w(()=>{switch(R.step){case"REJECT":return"Indeferimento em lote";case"ACCEPT":return"Deferimento em lote";case"SUMMON":return"Convoca\xE7\xE3o em lote";default:return""}});Me(()=>{T.value&&R.step==="ACCEPT"&&M()});const X=()=>{T.value=!1,k.value="",$.value=[],z.value=void 0,V.value=!1,l.value=!1,A.value=null,D.value=null,y.value=!1,N.value=0},j=()=>{X(),W("load")},_=()=>{if(!Number(z.value)){l.value=!0,A.value="\xC9 necess\xE1rio selecionar uma turma para realizar o Deferimento da pr\xE9-matr\xEDcula.",D.value="";return}y.value=!0,G(()=>ro({ids:R.preregistrations.map(u=>Number(u)),classroom:Number(z.value)})).then(({acceptPreRegistrations:u})=>{u&&(V.value=!0,N.value=u.length)}).catch(u=>{u.response.data.errors&&u.response.data.errors.length?(l.value=!0,V.value=!0,A.value="N\xE3o foi poss\xEDvel realizar o deferimento de todos os(as) alunos(as)",D.value=u.response.data.errors.map(b=>{var E;return(E=b.extensions)==null?void 0:E.message}).join("<br>"),u.response.data.data.acceptPreRegistrations&&(N.value=u.response.data.data.acceptPreRegistrations.length)):u.errors&&u.errors.length&&(l.value=!0,A.value="N\xE3o foi poss\xEDvel realizar o deferimento de todos os(as) alunos(as)",D.value=u.errors.map(b=>{var E;return(E=b.extensions)==null?void 0:E.message}).join("<br>"))}).finally(()=>{y.value=!1})},O=()=>{y.value=!0,Y(()=>io({ids:R.preregistrations,justification:k.value})).then(({rejectPreRegistrations:u})=>{u&&(V.value=!0,N.value=u.length)}).catch(u=>{if(u.errors&&u.errors.length){l.value=!0,A.value=u.errors[0].message,D.value=u.errors.map(b=>{var E;return(E=b.extensions)==null?void 0:E.message}).join("<br>");return}}).finally(()=>{y.value=!1})},i=()=>{y.value=!0,L(()=>co({ids:R.preregistrations,justification:k.value})).then(({summonPreRegistrations:u})=>{u&&(V.value=!0,N.value=u.length)}).catch(u=>{u.response.data.errors&&u.response.data.errors.length&&(l.value=!0,A.value="N\xE3o foi poss\xEDvel realizar a convoca\xE7\xE3o de todos os(as) respons\xE1veis(as)",D.value=u.response.data.errors.map(b=>{var E;return(E=b.extensions)==null?void 0:E.message}).join("<br>"))}).finally(()=>{y.value=!1})},M=()=>{$.value=[],H(()=>Ue({school:R.filter.school,grade:R.filter.grade,year:R.processYear}))};return(u,b)=>(a(),U(Ve,{modelValue:s(T),"onUpdate:modelValue":b[3]||(b[3]=E=>Ge(T)?T.value=E:null),large:!0,title:s(C),"overflow-visible":!V.value&&x.step==="ACCEPT","no-footer":""},{body:J(()=>[x.preregistrations&&V.value===!1?(a(),r("div",bo,[e("div",yo,[x.step==="REJECT"?(a(),r("div",xo,Co)):c("",!0),x.step==="ACCEPT"?(a(),r("div",$o,[ko,So,f(P,{modelValue:z.value,"onUpdate:modelValue":b[0]||(b[0]=E=>z.value=E),"container-class":"col-12 form-group mt-3",rules:"required",label:"Para qual turma deseja designar os(as) alunos(as)?",name:"classroom",type:"SELECT",errors:l.value,options:s($)},null,8,["modelValue","errors","options"])])):c("",!0),x.step==="SUMMON"?(a(),r("div",Ro,Vo)):c("",!0),x.step==="SUMMON"?(a(),r("div",Do,[Io,Z(e("textarea",{"onUpdate:modelValue":b[1]||(b[1]=E=>k.value=E),class:"form-control",rows:"3"},null,512),[[_e,k.value]])])):c("",!0),x.step==="REJECT"?(a(),r("div",Oo,[Mo,Z(e("textarea",{"onUpdate:modelValue":b[2]||(b[2]=E=>k.value=E),class:"form-control",rows:"3"},null,512),[[_e,k.value]])])):c("",!0),l.value?(a(),r("div",Po,[e("h2",jo,n(A.value),1),e("span",{innerHTML:D.value},null,8,Bo)])):c("",!0),e("div",Uo,[x.step==="SUMMON"?(a(),U(S,{key:0,label:"Convocar respons\xE1veis",loading:y.value,color:"summon",outline:"",class:"ml-3 pmd-custom",icon:"pmd-summon","no-caps":"","no-wrap":"","loading-normal":"",onClick:i},null,8,["loading"])):c("",!0),x.step==="REJECT"?(a(),U(S,{key:1,label:"Indeferir pr\xE9-matr\xEDculas",loading:y.value,color:"rejected",outline:"",class:"ml-3 pmd-custom",icon:"pmd-rejected","no-caps":"","no-wrap":"","loading-normal":"",onClick:O},null,8,["loading"])):c("",!0),x.step==="ACCEPT"?(a(),U(S,{key:2,label:"Deferir pr\xE9-matr\xEDculas",loading:y.value,color:"accepted",outline:"",class:"ml-3 pmd-custom",icon:"pmd-accepted","no-caps":"","no-wrap":"","loading-normal":"",onClick:_},null,8,["loading"])):c("",!0)])])])):V.value===!1?(a(),r("div",Lo,"Carregando..")):c("",!0),x.preregistrations&&V.value===!0?(a(),r("div",zo,[x.step==="ACCEPT"?(a(),r("div",Fo,n(N.value)+" matr\xEDcula(s) deferida(s) com sucesso ",1)):c("",!0),x.step==="REJECT"?(a(),r("div",Wo,n(N.value)+" matr\xEDcula(s) indeferida(s) com sucesso ",1)):c("",!0),x.step==="SUMMON"?(a(),r("div",Go,n(N.value)+" matr\xEDcula(s) convocada(s) com sucesso ",1)):c("",!0),l.value?(a(),r("div",Ho,[e("h2",Jo,n(A.value),1),e("span",{innerHTML:D.value},null,8,qo)])):c("",!0),e("div",Yo,[f(S,{class:"ml-3 mr-3 w-50",color:"success",label:"Fechar","no-caps":"","no-wrap":"",onClick:j})])])):c("",!0)]),_:1},8,["modelValue","title","overflow-visible"]))}});var Oe=function(x,W,R,G){var Y=typeof G<"u"?[G,x]:[x],L=new Blob(Y,{type:R||"application/octet-stream"});if(typeof window.navigator.msSaveBlob<"u")window.navigator.msSaveBlob(L,W);else{var H=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(L):window.webkitURL.createObjectURL(L),$=document.createElement("a");$.style.display="none",$.href=H,$.setAttribute("download",W),typeof $.download>"u"&&$.setAttribute("target","_blank"),document.body.appendChild($),$.click(),setTimeout(function(){document.body.removeChild($),window.URL.revokeObjectURL(H)},200)}};const Ko=e("h1",null,"Pr\xE9-matr\xEDculas",-1),Qo={class:"row m-0 mt-1 filter-gutters mb-md-3"},Zo={class:"row m-0 filter-gutters mt-md-4"},et={class:"d-flex m-0 mt-3 filter-gutters flex-column flex-lg-row"},ot={class:"d-flex flex-grow-1"},tt={class:"d-flex justify-content-end flex-grow-1 mt-2 mt-md-0"},st={class:"d-flex flex-column flex-lg-row mb-4"},lt={class:"mb-3 mb-lg-0"},at=e("option",{value:null},"Ordenar por:",-1),nt={class:"ml-lg-auto"},rt={class:"align-items-baseline d-flex font-hind mb-2"},it=e("div",{class:"mr-2"},"Mostrar",-1),dt={class:"mr-2"},ct=e("div",null,"registros por p\xE1gina",-1),ut={key:1,class:"table table-responsive table-striped table-vcenter"},mt={class:"w-1"},pt={class:"custom-control custom-checkbox"},vt=e("label",{class:"custom-control-label",for:"allChecked"},null,-1),ht=e("th",null,"Status",-1),_t=e("th",null,"Protocolo",-1),ft=e("th",null,"Nome do(a) aluno(a)",-1),gt=e("th",null,"Escola",-1),Et=e("th",null,"Posi\xE7\xE3o",-1),bt=e("th",null,"S\xE9rie",-1),yt=e("th",null,"Turno",-1),xt=e("th",null,"Tipo",-1),wt={key:0},Tt=e("td",{colspan:"9"},"Nenhum resultado.",-1),Ct=[Tt],$t={class:"w-1"},kt={class:"custom-control custom-checkbox"},St=["id","value"],Rt=["for"],Nt=["onClick"],At={key:0},Vt={class:"align-top"},Dt={key:1},It={class:"align-top"},Ot={key:0},Mt={class:"align-top"},Pt={key:1},jt={class:"align-top"},Bt={key:2,class:"row justify-content-center mt-4"},Ut={class:"col-12 col-lg-3"},Lt={class:"row"},zt={class:"row"},Ft={class:"col-12"},Wt=Ae({__name:"PreRegistrationList",setup(x){const{dialog:W}=Xe(),{loader:R}=q(),{loader:G}=q(),{loader:Y,loading:L}=q(),{loader:H,loading:$}=Ke(d({title:"Aten\xE7\xE3o!",description:"N\xE3o foi poss\xEDvel emitir o relat\xF3rio. Verifique os filtros e tente novamente."})),k=Be(),z=Pe(),V=je(),l=w(()=>V),A=d(),D=d(null),y=d(!1),N=d(),T=d(!1),C=d([]),X=d(),j=d(),_=d([]),O=d({search:"",process:null,school:null,grade:null,canAcceptInBatch:!1,sort:null,year:null,schools:null}),i=d({search:"",process:null,school:null,grade:null,sort:null,canAcceptInBatch:!1,year:null,schools:null}),M=d([]),u=d([]),b=d([]),E=d([]),ge=d(["REGISTRATION","REGISTRATION_RENEWAL","WAITING_LIST"]),Ee=d(["REJECTED","ACCEPTED","WAITING","SUMMONED","IN_CONFIRMATION"]),de=d([]),F=d(25),be=d([{key:25,label:"25"},{key:50,label:"50"},{key:100,label:"100"},{key:200,label:"200"},{key:400,label:"400"}]),K=d(!0),oe=d(!1),Q=d({template:1,showStudentShortName:!0}),ce=w(()=>C.value.length===0),ye=w(()=>i.value.canAcceptInBatch?C.value.length===0:!0),xe=w(()=>C.value.length===0),we=w(()=>{let h=[];return i.value.year&&(h=M.value.filter(o=>o.schoolYear.year===i.value.year)),h}),Te=w(()=>{const h={key:null,label:"Nenhum"},o=ge.value.map(g=>({key:g,label:le(g)}));return o.unshift(h),o}),ue=w(()=>{const h={key:null,label:"Nenhum"},o=E.value.map(g=>({key:g.id,label:g.name}));return o.unshift(h),o}),Ce=w(()=>{const h={key:null,label:"Nenhum"},o=Ee.value.map(g=>({key:g,label:Ne(g)}));return o.unshift(h),o}),$e=w(()=>K.value===!1&&_.value.length===0),ke=()=>{Y(()=>vo(i.value)).then(h=>{Oe(h,"pre-matricula.csv")})},me=()=>{const h=M.value.find(o=>o.id===i.value.process);D.value=h.schoolYear.year,N.value="ACCEPT",y.value=!0},Se=()=>{N.value="REJECT",y.value=!0},pe=()=>{N.value="SUMMON",y.value=!0},m=h=>{K.value=!0;const o={...i.value,page:h};Object.keys(o).forEach(g=>{(!o[g]||o[g]==="")&&delete o[g]}),k.auth.user&&k.auth.user.level>=4&&(o.schools=k.auth.user.schools),R(()=>uo({first:Number(F.value),...o})).then(g=>{X.value=g.stats,_.value=g.preregistrations,j.value=g.paginator,C.value=[];const{process:se,school:t,grade:I}=i.value;se&&t&&I&&(i.value.canAcceptInBatch=!0)}).finally(()=>{K.value=!1})},v=h=>{h.target.checked||(T.value=!1),C.value.length===_.value.length&&(T.value=!0)},p=h=>{h.target.checked?C.value=_.value.map(g=>g.id):C.value=[]},te=()=>{i.value={...O.value},m(1)},Re=()=>{const{process:h}=i.value;if(!h){W({title:"Aten\xE7\xE3o!",description:"Selecione um processo.",titleClass:"danger",iconLeft:"status-red"});return}const o={...i.value};Object.assign(o,{...Q.value}),H(()=>mo(o)).then(g=>{Oe(g,"pre-matricula.pdf")}).finally(()=>{oe.value=!1})},le=h=>{switch(h){case"REGISTRATION":return"Matr\xEDcula";case"REGISTRATION_RENEWAL":return"Rematr\xEDcula";case"WAITING_LIST":default:return"Lista de espera"}},B=h=>{switch(h){case"REGISTRATION":return"badge-blue";case"REGISTRATION_RENEWAL":return"badge-cyan";case"WAITING_LIST":default:return"badge-yellow"}},ae=h=>{z.push({name:"preregistration.modal",params:{protocol:h}})};(()=>{const h={};k.auth.user&&k.auth.user.level>=4&&(h.schools=k.auth.user.schools),G(()=>po(h)).then(o=>{M.value=o.processes.sortBy("name"),u.value=o.schools.sortBy("name"),b.value=o.grades.sortBy("name"),E.value=o.periods.sortBy("name");const g=[],se=[];o.processes.forEach(I=>{I.totalPreRegistrations>0?g.push(I.schoolYear.year):se.push(I.schoolYear.year)}),g.sort().reverse();const t=g[0];de.value=g.concat(se).filter((I,ze,Fe)=>Fe.indexOf(I)===ze).map(I=>({key:I,label:I})).sortBy("key").reverse(),t&&(i.value.year=t),u.value.length===1&&(i.value.school=u.value[0].id),m(1)})})(),fe(l,h=>{m(h.query.page||1)},{deep:!0}),fe(F,()=>{j.value&&m(j.value.currentPage)},{deep:!0});const Le={toExport:ke};return(h,o)=>{const g=Je("router-view"),se=qe("tooltip");return a(),r("main",null,[Ko,f(Qe,{stats:X.value},null,8,["stats"]),f(eo,{class:"bg-primary mb-5"},{default:J(()=>[f(Ze,{class:"pl-2 pr-2"},{default:J(()=>[e("form",{onSubmit:o[13]||(o[13]=He(t=>m(1),["prevent"]))},[e("div",Qo,[f(P,{modelValue:i.value.search,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value.search=t),"container-class":"col-12 col-md-4 mb-2 mb-md-0",name:"search",placeholder:"Nome do(a) aluno(a)",type:"TEXT"},null,8,["modelValue"]),f(P,{modelValue:i.value.year,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.year=t),"container-class":"col-12 col-md-2 mb-2 mb-md-0",name:"year",placeholder:"Filtrar ano",type:"SELECT",options:de.value},null,8,["modelValue","options"]),f(P,{modelValue:i.value.process,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.process=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"process",placeholder:"Filtrar por processo",type:"SELECT",options:s(we),searchable:"",onChange:o[3]||(o[3]=t=>i.value.canAcceptInBatch=!1)},null,8,["modelValue","options"]),f(P,{modelValue:i.value.type,"onUpdate:modelValue":o[4]||(o[4]=t=>i.value.type=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"type",placeholder:"Filtrar por tipo",type:"SELECT",options:s(Te)},null,8,["modelValue","options"])]),e("div",Zo,[f(P,{modelValue:i.value.school,"onUpdate:modelValue":o[5]||(o[5]=t=>i.value.school=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"school",placeholder:"Filtrar por escola",type:"SELECT",options:u.value,searchable:"",onChange:o[6]||(o[6]=t=>i.value.canAcceptInBatch=!1)},null,8,["modelValue","options"]),f(P,{modelValue:i.value.grade,"onUpdate:modelValue":o[7]||(o[7]=t=>i.value.grade=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"grade",placeholder:"Filtrar por s\xE9rie",type:"SELECT",options:b.value,searchable:"",onChange:o[8]||(o[8]=t=>i.value.canAcceptInBatch=!1)},null,8,["modelValue","options"]),f(P,{modelValue:i.value.period,"onUpdate:modelValue":o[9]||(o[9]=t=>i.value.period=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"period",placeholder:"Filtrar por turno",type:"SELECT",options:s(ue)},null,8,["modelValue","options"]),f(P,{modelValue:i.value.status,"onUpdate:modelValue":o[10]||(o[10]=t=>i.value.status=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"status",placeholder:"Filtrar por status",type:"SELECT",options:s(Ce)},null,8,["modelValue","options"])]),e("div",et,[e("div",ot,[f(S,{label:"Emitir relat\xF3rio",color:"white",outline:"",class:"ml-2","no-caps":"","no-wrap":"",icon:"mdi-note-text-outline","loading-normal":"",onClick:o[11]||(o[11]=t=>oe.value=!0)})]),e("div",tt,[f(S,{"data-test":"cleanFilter",label:"Limpar",color:"white",flat:"",class:"mr-3","no-caps":"","no-wrap":"",onClick:te}),f(S,{"data-test":"btn-search-pre-registration",label:"Buscar",color:"white",outline:"",class:"mr-2","no-caps":"","no-wrap":"",loading:K.value,"loading-normal":"",onClick:o[12]||(o[12]=t=>m(1))},null,8,["loading"])])])],32)]),_:1})]),_:1}),e("div",st,[e("div",lt,[f(Ie,{modelValue:i.value.sort,"onUpdate:modelValue":o[14]||(o[14]=t=>i.value.sort=t),options:s(oo)(),class:"custom-select",onChange:o[15]||(o[15]=t=>m(1))},{option:J(()=>[at]),_:1},8,["modelValue","options"])]),e("div",nt,[f(S,{"data-test":"summon",label:"Convocar respons\xE1veis",disable:s(xe),color:"summon",outline:"",class:"ml-0 ml-lg-3 mb-2 mb-lg-0 pmd-custom",icon:"pmd-summon","no-caps":"","no-wrap":"",onClick:pe},null,8,["disable"]),f(S,{"data-test":"reject",label:"Indeferir pr\xE9-matr\xEDcula",disable:s(ce),color:"rejected",outline:"",class:"ml-0 ml-lg-3 mb-2 mb-lg-0 pmd-custom",icon:"pmd-rejected","no-caps":"","no-wrap":"",onClick:Se},null,8,["disable"]),f(S,{"data-test":"accept",label:"Deferir pr\xE9-matr\xEDcula",disable:s(ye),color:"accepted",outline:"",class:"ml-0 ml-lg-3 mb-2 mb-lg-0 pmd-custom",icon:"pmd-accepted","no-caps":"","no-wrap":"",onClick:me},null,8,["disable"])])]),e("div",rt,[it,e("div",dt,[f(Ie,{modelValue:F.value,"onUpdate:modelValue":o[16]||(o[16]=t=>F.value=t),options:be.value,class:"form-control form-control-sm"},null,8,["modelValue","options"])]),ct]),K.value?(a(),U(lo,{key:0})):(a(),r("table",ut,[e("thead",null,[e("tr",null,[e("th",mt,[e("div",pt,[Z(e("input",{id:"allChecked","onUpdate:modelValue":o[17]||(o[17]=t=>T.value=t),type:"checkbox",class:"custom-control-input",onChange:p},null,544),[[De,T.value]]),vt])]),ht,_t,ft,gt,Et,bt,yt,xt])]),e("tbody",null,[s($e)?(a(),r("tr",wt,Ct)):(a(!0),r(ne,{key:1},ve(_.value,t=>(a(),r("tr",{key:t.id},[e("td",$t,[e("div",kt,[Z(e("input",{id:`checkbox-${t.id}`,"onUpdate:modelValue":o[18]||(o[18]=I=>C.value=I),value:t.id,type:"checkbox",class:"custom-control-input",onChange:v},null,40,St),[[De,C.value]]),e("label",{for:`checkbox-${t.id}`,class:"custom-control-label"},null,8,Rt)])]),e("td",null,[Z(e("span",{class:re(s(he)(t.status))},null,2),[[se,s(Ne)(t.status),void 0,{"bottom-start":!0}]])]),e("td",null,[e("a",{"data-test":"protocol",href:"javascript:void(0)",onClick:I=>ae(t.protocol)}," #"+n(t.protocol),9,Nt)]),e("td",null,n(t.student.name),1),e("td",null,[ee(n(t.school.name)+" ",1),t.waiting?(a(),r("div",At,[e("small",Vt,n(t.waiting.school.name),1),e("span",{class:re(s(he)(t.waiting.status))},null,2)])):c("",!0),t.parent?(a(),r("div",Dt,[e("small",It,n(t.parent.school.name),1),e("span",{class:re(s(he)(t.parent.status))},null,2)])):c("",!0)]),e("td",null,[ee(n(t.position)+"\xBA ",1),t.waiting?(a(),r("div",Ot,[e("small",Mt,n(t.waiting.position)+"\xBA ",1)])):c("",!0),t.parent?(a(),r("div",Pt,[e("small",jt,n(t.parent.position)+"\xBA ",1)])):c("",!0)]),e("td",null,n(t.grade?t.grade.name:"-"),1),e("td",null,n(t.period?t.period.name:"-"),1),e("td",null,[e("span",{class:re([B(t.type),"badge"])},n(le(t.type)),3)])]))),128))])])),f(to,{"paginator-info":j.value,onPage:o[19]||(o[19]=t=>m(t))},null,8,["paginator-info"]),j.value&&j.value.total?(a(),r("div",Bt,[e("div",Ut,[f(S,{"data-test":"toExport",label:"Exportar",loading:s(L),class:"w-100",color:"primary","no-caps":"","no-wrap":"","loading-normal":"",onClick:o[20]||(o[20]=t=>Le.toExport())},null,8,["loading"])])])):c("",!0),y.value?(a(),U(Xo,{key:3,modelValue:y.value,"onUpdate:modelValue":o[21]||(o[21]=t=>y.value=t),filter:i.value,preregistrations:C.value,"process-year":D.value,step:N.value,onLoad:m},null,8,["modelValue","filter","preregistrations","process-year","step"])):c("",!0),f(Ve,{ref_key:"fieldsModal",ref:A,modelValue:oe.value,"onUpdate:modelValue":o[26]||(o[26]=t=>oe.value=t),"no-footer":"",title:"Emitir Relat\xF3rio","is-overflow-visible":""},{body:J(()=>[e("div",Lt,[f(P,{id:"reportModel",modelValue:Q.value.template,"onUpdate:modelValue":o[22]||(o[22]=t=>Q.value.template=t),label:"Modelo",rules:"required",name:"reportModel",type:"SELECT","allow-clear":!1,searchable:!1,options:s(so)(),placeholder:"Selecione o modelo","container-class":"col-12 form-group","onOpen:options":o[23]||(o[23]=t=>A.value.setOverflowVisible(!0)),"onClose:options":o[24]||(o[24]=t=>A.value.setOverflowVisible(!1))},null,8,["modelValue","options"]),f(P,{modelValue:Q.value.showStudentShortName,"onUpdate:modelValue":o[25]||(o[25]=t=>Q.value.showStudentShortName=t),name:"showStudentShortName","container-class":"col-12 form-group",label:"Exibir apenas iniciais do nome do candidato?",type:"CHECKBOX"},null,8,["modelValue"])])]),footer:J(()=>[e("div",zt,[e("div",Ft,[f(S,{"data-test":"toReport",loading:s($),color:"primary",class:"w-100",label:"Emitir relat\xF3rio","no-caps":"","no-wrap":"",onClick:Re},null,8,["loading"])])])]),_:1},8,["modelValue"]),f(g)])}}}),jl=Object.freeze(Object.defineProperty({__proto__:null,default:Wt},Symbol.toStringTag,{value:"Module"})),Gt={class:"m-auto",style:{"max-width":"740px"}},Ht={key:0,class:"mt-4 text-danger font-weight-bold"},Jt=ee(" Tem certeza que deseja indeferir a pr\xE9-matr\xEDcula? "),qt=e("hr",null,null,-1),Yt=[Jt,qt],Xt={key:1,class:"mt-4 font-weight-bold"},Kt=ee(" Selecione a turma que deseja matricular o(a) aluno(a) para completar o deferimento da pr\xE9-matr\xEDcula do(a) aluno(a). "),Qt=e("hr",null,null,-1),Zt=[Kt,Qt],es={key:2},os=e("div",{class:"mt-4 text-danger font-weight-bold"},"Indeferido",-1),ts={class:"row mt-4"},ss={class:"col-6"},ls=e("dt",{class:"font-hind font-size-10"}," Justificativa do indeferimento ",-1),as=e("hr",null,null,-1),ns={key:3},rs=e("div",{class:"mt-4 font-weight-bold",style:{color:"#1900b4"}}," Em convoca\xE7\xE3o ",-1),is={class:"row mt-4"},ds={class:"col-12"},cs=e("dt",{class:"font-hind font-size-10"},"Observa\xE7\xF5es",-1),us=e("hr",null,null,-1),ms={key:4},ps=e("div",{class:"mt-4 text-success font-weight-bold"},"Deferido",-1),vs={class:"row mt-4"},hs={class:"col-6"},_s=e("dt",{class:"font-hind font-size-10"},"Escola",-1),fs={key:0,class:"col-6"},gs=e("dt",{class:"font-hind font-size-10"},"Turma",-1),Es=e("hr",null,null,-1),bs={class:"row mt-4"},ys={class:"col-6"},xs=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1),ws={class:"col-6"},Ts=e("dt",{class:"font-hind font-size-10"},"Tipo",-1),Cs={class:"col-6"},$s=e("dt",{class:"font-hind font-size-10"},"S\xE9rie",-1),ks={class:"col-6"},Ss=e("dt",{class:"font-hind font-size-10"},"Turno",-1),Rs={class:"col-12"},Ns=e("dt",{class:"font-hind font-size-10"},"Fase escolar",-1),As={class:"col-12"},Vs=e("dt",{class:"font-hind font-size-10"},"Escola",-1),Ds={class:"col-12"},Is=e("dt",{class:"font-hind font-size-10"},"Data da solicita\xE7\xE3o",-1),Os={key:5,class:"row"},Ms={key:0,class:"col-12 mb-3"},Ps={class:"alert badge-yellow"},js=e("strong",null," Este aluno tamb\xE9m est\xE1 em lista de espera: ",-1),Bs={class:"row mt-3"},Us={class:"col-2 mb-0"},Ls=e("dt",{class:"font-hind font-size-10"},"Protocolo",-1),zs={class:"col-2 mb-0"},Fs=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1),Ws={class:"col-8 mb-0"},Gs=e("dt",{class:"font-hind font-size-10"},"Escola",-1),Hs={key:1,class:"col-12 mb-3"},Js={class:"alert badge-blue"},qs=e("strong",null," Este(a) aluno(a) tamb\xE9m possui uma outra solicita\xE7\xE3o de matr\xEDcula: ",-1),Ys={class:"row mt-3"},Xs={class:"col-2 mb-0"},Ks=e("dt",{class:"font-hind font-size-10"},"Protocolo",-1),Qs={class:"col-2 mb-0"},Zs=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1),el={class:"col-8 mb-0"},ol=e("dt",{class:"font-hind font-size-10"},"Escola",-1),tl={class:"font-hind font-size-10"},sl=e("h3",{class:"font-hind-18-primary mt-4"}," Dados do(a) respons\xE1vel pelo(a) aluno(a) ",-1),ll=e("hr",null,null,-1),al={class:"row"},nl={class:"col-6"},rl=e("dt",{class:"font-hind font-size-10"},"Rela\xE7\xE3o com o(a) aluno(a)",-1),il={class:"row"},dl={class:"font-hind font-size-10"},cl={class:"col-6"},ul=e("dt",{class:"font-hind font-size-10"},"Endere\xE7o",-1),ml={class:"col-6"},pl=e("dt",{class:"font-hind font-size-10"},"N\xFAmero",-1),vl={key:0,class:"col-6"},hl=e("dt",{class:"font-hind font-size-10"},"Complemento",-1),_l={class:"col-6"},fl=e("dt",{class:"font-hind font-size-10"},"Bairro",-1),gl={class:"col-6"},El=e("dt",{class:"font-hind font-size-10"},"Cidade",-1),bl={class:"col-6"},yl=e("dt",{class:"font-hind font-size-10"}," Foi alterado a localiza\xE7\xE3o manualmente? ",-1),xl={key:7,class:"form-group"},wl=e("label",{class:"form-label"},"Observa\xE7\xF5es (opcional)",-1),Tl={key:8,class:"form-group"},Cl=e("label",{class:"form-label"},"Justificativa (opcional)",-1),$l={key:9,class:"mt-4 font-weight-bold"},kl={class:"row"},Sl={key:10},Rl={class:"text-danger"},Nl=["innerHTML"],Al={class:"d-flex flex-column flex-lg-row justify-content-center"},Vl={inheritAttrs:!1},Dl=Ae({...Vl,__name:"PreRegistrationModal",setup(x){const W=Ye("$filters"),{loader:R,loading:G}=ie(),{loader:Y,loading:L}=q(),{loader:H,loading:$}=q(),{loader:k,data:z}=q([]),{loader:V,data:l}=q({}),{loader:A,loading:D}=ie(),y=Be(),N=je(),T=Pe(),C=d({responsible:[],student:[]}),X=d({}),j=d({}),_=d("SHOW"),O=d(""),i=d(),M=d(!1),u=d(),b=d(),E=d(!0),ge=w(()=>y.isAdmin),Ee=w(()=>y.isCoordinator),de=w(()=>y.isSecretary),F=w(()=>Object.keys(l.value).length===0),be=w(()=>(_.value==="SHOW"||_.value==="ACCEPT")&&l.value.status!=="ACCEPTED"),K=w(()=>(ge.value||Ee.value||de.value)&&l.value.status!=="WAITING"&&_.value==="SHOW"),oe=w(()=>(_.value==="SHOW"||_.value==="REJECT")&&(l.value.status==="WAITING"||l.value.status==="SUMMONED")),Q=w(()=>(_.value==="SHOW"||_.value==="SUMMON")&&l.value.status==="WAITING"),ce=(m,v)=>v==="STUDENT"?m.filter(j.value[m.key]):m.filter(X.value[m.key]),ye=()=>{if(M.value=!1,_.value==="SHOW")_.value="ACCEPT";else if(_.value==="ACCEPT"){if(!Number(i.value)){M.value=!0,u.value="\xC9 necess\xE1rio selecionar uma turma para realizar o Deferimento da pr\xE9-matr\xEDcula.",b.value="";return}R(()=>ho({ids:[l.value.id].map(m=>Number(m)),classroom:Number(i.value)})).then(()=>{T.push({name:"preregistrations"})}).catch(m=>{var v;M.value=!0,u.value=m.response.data.errors[0].message,b.value=(v=m.response.data.errors[0].extensions)==null?void 0:v.message})}},xe=()=>{_.value==="SHOW"?(O.value="",_.value="REJECT"):_.value==="REJECT"&&Y(()=>_o({ids:[l.value.id],justification:O.value})).then(()=>{T.push({name:"preregistrations"})})},we=()=>{H(()=>fo({ids:[l.value.id]})).then(()=>{T.push({name:"preregistrations"})})},Te=()=>{k(()=>Ue({period:l.value.period.id,school:l.value.school.id,grade:l.value.grade.id,year:l.value.process.schoolYear.year}))},ue=m=>{T.push({name:"preregistration.modal",params:{protocol:m}})},Ce=m=>{switch(m){case"REGISTRATION":return"Matr\xEDcula";case"REGISTRATION_RENEWAL":return"Rematr\xEDcula";case"WAITING_LIST":default:return"Lista de espera"}},$e=m=>{switch(m){case"REGISTRATION":return"badge-blue";case"REGISTRATION_RENEWAL":return"badge-cyan";case"WAITING_LIST":default:return"badge-yellow"}},ke=m=>{var v;return(v=y.relationTypes.find(p=>p.key===m))==null?void 0:v.label},me=m=>{l.value={},V(()=>go({protocol:m})).then(v=>{const{fields:p,data:te}=ao(v.process),{fields:Re,data:le}=no(v.process);v.fields.filter(B=>B.field.group==="RESPONSIBLE").forEach(B=>{const ae=`field_${B.field.id}`;te[ae]=B.value}),v.fields.filter(B=>B.field.group==="STUDENT").forEach(B=>{const ae=`field_${B.field.id}`;le[ae]=B.value}),C.value.responsible=p.sortBy("order"),X.value={...te,...v.responsible},C.value.student=Re.sortBy("order"),j.value={...le,...v.student},Te()})},Se=()=>{_.value==="SHOW"?(O.value="",_.value="SUMMON"):A(()=>Eo({ids:[l.value.id],justification:O.value})).then(()=>{T.push({name:"preregistrations"})}).catch(m=>{M.value=!0,u.value="N\xE3o foi poss\xEDvel realizar a convoca\xE7\xE3o de todos os(as) respons\xE1veis(as)",b.value=m.response.data.errors.map(v=>{var p;return(p=v.extensions)==null?void 0:p.message}).join("<br>")})},pe=w(()=>N);return fe(pe,m=>{me(m.params.protocol)},{deep:!0}),fe(E,m=>{m||T.push({name:"preregistrations"})}),Me(()=>me(pe.value.params.protocol)),(m,v)=>(a(),U(Ve,{modelValue:E.value,"onUpdate:modelValue":v[5]||(v[5]=p=>E.value=p),"title-class":"font-hind-18-primary text-uppercase text-primary",title:s(F)?"":s(l).student.student_name,"icon-right":s(he)(s(F)?"":s(l).status),"tooltip-icon":s(Ne)(s(F)?"":s(l).status),"initial-loading":s(F),large:!0,"loading-text":"",onCloseModal:v[6]||(v[6]=p=>m.$router.push({name:"preregistrations"}))},{body:J(()=>[e("div",Gt,[_.value==="REJECT"?(a(),r("div",Ht,Yt)):c("",!0),_.value==="ACCEPT"?(a(),r("div",Xt,Zt)):c("",!0),s(l).status==="REJECTED"?(a(),r("div",es,[os,e("div",ts,[e("dl",ss,[ls,e("dd",null,n(s(l).observation),1)])]),as])):c("",!0),s(l).status==="SUMMONED"&&s(l).observation?(a(),r("div",ns,[rs,e("div",is,[e("dl",ds,[cs,e("dd",null,n(s(l).observation),1)])]),us])):c("",!0),s(l).status==="ACCEPTED"?(a(),r("div",ms,[ps,e("div",vs,[e("dl",hs,[_s,e("dd",null,n(s(l).school.name),1)]),s(l).classroom?(a(),r("dl",fs,[gs,e("dd",null,n(s(l).classroom.name),1)])):c("",!0)]),Es])):c("",!0),e("div",bs,[e("dl",ys,[xs,e("dd",null,n(s(l).position)+"\xBA",1)]),e("dl",ws,[Ts,e("dd",null,[e("span",{class:re([$e(s(l).type),"badge"])},n(Ce(s(l).type)),3)])]),e("dl",Cs,[$s,e("dd",null,n(s(l).grade.name),1)]),e("dl",ks,[Ss,e("dd",null,n(s(l).period.name),1)]),e("dl",Rs,[Ns,e("dd",null,n(s(l).grade.course.name),1)]),e("dl",As,[Vs,e("dd",null,n(s(l).school.name),1)]),e("dl",Ds,[Is,e("dd",null,n(s(W).formatDateTime(s(l).date)),1)])]),_.value==="SHOW"?(a(),r("div",Os,[s(l).waiting?(a(),r("div",Ms,[e("div",Ps,[js,e("div",Bs,[e("dl",Us,[Ls,e("dd",null,[e("a",{href:"javascript:void(0)",onClick:v[0]||(v[0]=p=>ue(s(l).waiting.protocol))}," #"+n(s(l).waiting.protocol),1)])]),e("dl",zs,[Fs,e("dd",null,n(s(l).waiting.position)+"\xBA",1)]),e("dl",Ws,[Gs,e("dd",null,n(s(l).waiting.school.name),1)])])])])):c("",!0),s(l).parent?(a(),r("div",Hs,[e("div",Js,[qs,e("div",Ys,[e("dl",Xs,[Ks,e("dd",null,[e("a",{href:"javascript:void(0)",onClick:v[1]||(v[1]=p=>ue(s(l).parent.protocol))}," #"+n(s(l).parent.protocol),1)])]),e("dl",Qs,[Zs,e("dd",null,n(s(l).parent.position)+"\xBA",1)]),e("dl",el,[ol,e("dd",null,n(s(l).parent.school.name),1)])])])])):c("",!0),(a(!0),r(ne,null,ve(C.value.student,p=>(a(),r("dl",{key:p.id,class:"col-6"},[e("dt",tl,n(p.field.name),1),e("dd",null,n(ce(p,"STUDENT")),1)]))),128))])):c("",!0),_.value==="SHOW"?(a(),r(ne,{key:6},[sl,ll,e("div",al,[e("dl",nl,[rl,e("dd",null,n(ke(s(l).relationType)),1)])]),e("div",il,[(a(!0),r(ne,null,ve(C.value.responsible,p=>(a(),r("dl",{key:p.id,class:"col-6"},[e("dt",dl,n(p.field.name),1),e("dd",null,n(ce(p,"RESPONSIBLE")),1)]))),128))]),(a(!0),r(ne,null,ve(s(l).responsible.responsible_address,(p,te)=>(a(),r("div",{key:te,class:"row"},[e("dl",cl,[ul,e("dd",null,n(p.address),1)]),e("dl",ml,[pl,e("dd",null,n(p.number),1)]),p.complement?(a(),r("dl",vl,[hl,e("dd",null,n(p.complement),1)])):c("",!0),e("dl",_l,[fl,e("dd",null,n(p.neighborhood),1)]),e("dl",gl,[El,e("dd",null,n(p.city),1)]),e("dl",bl,[yl,e("dd",null,n(p.manualChangeLocation?"Sim":"N\xE3o"),1)])]))),128))],64)):c("",!0),_.value==="SUMMON"?(a(),r("div",xl,[wl,Z(e("textarea",{"onUpdate:modelValue":v[2]||(v[2]=p=>O.value=p),class:"form-control",rows:"3"},null,512),[[_e,O.value]])])):c("",!0),_.value==="REJECT"?(a(),r("div",Tl,[Cl,Z(e("textarea",{"onUpdate:modelValue":v[3]||(v[3]=p=>O.value=p),class:"form-control",rows:"3"},null,512),[[_e,O.value]])])):c("",!0),_.value==="ACCEPT"?(a(),r("div",$l,[e("div",kl,[f(P,{modelValue:i.value,"onUpdate:modelValue":v[4]||(v[4]=p=>i.value=p),"container-class":"col-12",name:"classroom",rules:"required",label:"Para qual turma deseja designar o aluno(a)?",type:"SELECT",errors:M.value,options:s(z)},null,8,["modelValue","errors","options"])])])):c("",!0),M.value?(a(),r("div",Sl,[e("h2",Rl,n(u.value),1),e("span",{innerHTML:b.value},null,8,Nl)])):c("",!0)])]),footer:J(()=>[e("div",Al,[s(Q)?(a(),U(S,{key:0,loading:s(D),color:"summon",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Convocar respons\xE1veis",icon:"pmd-summon","no-wrap":"","no-caps":"","loading-normal":"",onClick:Se},null,8,["loading"])):c("",!0),s(oe)?(a(),U(S,{key:1,loading:s(L),color:"rejected",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Indeferir pr\xE9-matr\xEDcula",icon:"pmd-rejected","no-wrap":"","no-caps":"","loading-normal":"",onClick:xe},null,8,["loading"])):c("",!0),s(K)?(a(),U(S,{key:2,loading:s($),color:"to-wait",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Voltar para em espera",icon:"pmd-to-wait","no-wrap":"","no-caps":"","loading-normal":"",onClick:we},null,8,["loading"])):c("",!0),s(be)?(a(),U(S,{key:3,loading:s(G),color:"accepted",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Deferir pr\xE9-matr\xEDcula",icon:"pmd-accepted","no-wrap":"","no-caps":"","loading-normal":"",onClick:ye},null,8,["loading"])):c("",!0)])]),_:1},8,["modelValue","title","icon-right","tooltip-icon","initial-loading"]))}}),Bl=Object.freeze(Object.defineProperty({__proto__:null,default:Dl},Symbol.toStringTag,{value:"Module"}));export{jl as P,Bl as a};
