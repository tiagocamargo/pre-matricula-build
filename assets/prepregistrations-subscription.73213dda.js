var Ae=Object.defineProperty,Pe=Object.defineProperties;var Ne=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var me=(s,p,a)=>p in s?Ae(s,p,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[p]=a,R=(s,p)=>{for(var a in p||(p={}))Ve.call(p,a)&&me(s,a,p[a]);if(ce)for(var a of ce(p))Le.call(p,a)&&me(s,a,p[a]);return s},pe=(s,p)=>Pe(s,Ne(p));import{a as K,n as ee,i as Oe,k as De,_ as P,c as be,b as se,X as M,q as ve,r as fe,u as Fe,t as Me,v as Ue}from"./common.017a279d.js";import{_ as Be,d as z,W as te,r as g,c as q,o as l,a as v,b as e,m as y,F as Z,j as Q,l as h,p as B,v as c,O as b,k,Z as ze,$ as He,Y as O,w as he,C as Ee,t as qe,a0 as Ge,u as je,a1 as We,g as Xe}from"./vendor.1f347d3d.js";import{p as Ye,l as Je,a as Ke,b as Ze}from"./shared/prepregistrations-subscription/preregistrations.93faf1b1.js";import{_ as Qe}from"./shared/prepregistrations-subscription/protocol.7827dafd.js";import{u as oe}from"./@vueuse/core.ebf6af6e.js";import{_ as _e,R as es,S as ss}from"./shared/prepregistrations-subscription/processes.325d95d1.js";import"./vue-the-mask.7c8603ed.js";import"./flatpickr.cab88106.js";import"./froala-editor.fa4daa16.js";import"./geolib.7538e95a.js";const A=s=>(ze("data-v-b6ca2bf4"),s=s(),He(),s),ts={class:"container-pmd"},os=A(()=>e("h2",{class:"font-muli-20-primary mb-4 text-center"}," Sua inscri\xE7\xE3o foi realizada com sucesso! ",-1)),as=A(()=>e("p",{class:"mb-4"},[O(" Para acompanhar a atualiza\xE7\xE3o da Pr\xE9-matr\xEDcula, n\xE3o esque\xE7a de anotar/salvar o(s) c\xF3digo(s) do(s) "),e("strong",null,"protocolo(s)"),O(" gerado(s). ")],-1)),ls={class:"m-auto",style:{"max-width":"340px"}},ns={key:0,class:"font-weight-bold"},rs={key:1,class:"font-weight-bold"},is={key:0},ds=A(()=>e("div",{class:"alert badge-yellow text-center text-uppercase"}," Lista de espera ",-1)),us=[ds],cs={key:1},ms=A(()=>e("div",{class:"alert badge-blue text-center text-uppercase"}," Pr\xE9-matr\xEDcula ",-1)),ps=[ms],vs={class:"pull-right text-right",style:{width:"120px",height:"90px"}},fs=["src","alt"],_s={class:"mb-0"},bs=A(()=>e("dt",{class:"mt-3"},"C\xF3digo do protocolo",-1)),hs={class:"font-hind-18-primary font-weight-bold"},Es=A(()=>e("dt",{class:"mt-3"},"Data da solicita\xE7\xE3o",-1)),ys=A(()=>e("dt",{class:"mt-3"},"Nome do(a) aluno(a)",-1)),gs=A(()=>e("dt",{class:"mt-3"},"S\xE9rie/Turno",-1)),xs=A(()=>e("dt",{class:"mt-3"},"Escola",-1)),$s={class:"mb-0"},Ts={key:0,class:"mb-0"},Ss={class:"text-muted text-size-10 mt-4"},ws=A(()=>e("span",{class:"text-uppercase"},"C\xF3digo de autenticidade:",-1)),Cs=A(()=>e("br",null,null,-1)),Rs={class:"text-dark"},ks=["innerHTML"],Is={class:"text-center mt-5 mb-4"},As={class:"row mb-5"},Ps={class:"col-12 col-md-4 offset-md-2"},Ns={class:"col-12 col-md-4"},Vs={class:"row"},Ls={class:"col-12 col-md-5 offset-md-1 mb-4"},Os={class:"col-12 col-md-5 mb-4"},Ds=A(()=>e("p",null," Preencha o campo abaixo com o e-mail que deve receber o(s) protocolo(s): ",-1)),Fs=z({__name:"Protocol",props:{preregistrations:null,process:null,student:null,responsible:null},emits:["finish"],setup(s,{emit:p}){const a=s,I=te("$filters"),{loader:w,loading:E}=K(),C=ee(),N=g(),f=g({email:!1}),x=oe(a,"process"),F=q(()=>({fields:[{type:"EMAIL",label:"",name:"email",rules:"required|email",containerClass:"col-12"}],buttons:[{type:"submit",label:"Prosseguir",class:"btn btn-block btn-primary",containerClass:"mt-3",block:!0}],buttonsContainer:{class:""}})),V=r=>{var o;return(o=x.value.grades.find($=>Number($.id)===Number(r)))==null?void 0:o.name},D=r=>{var o;return(o=x.value.periods.find($=>Number($.id)===Number(r)))==null?void 0:o.name},L=()=>{window.print()},_=()=>{f.value.email=!0,N.value=a.responsible.responsible_email},d=r=>{w(()=>Ye({email:r.email,preregistrations:a.preregistrations.map(o=>o.id)})).then(o=>{o?f.value.email=!1:alert("N\xE3o foi poss\xEDvel enviar o e-mail.")})},n=()=>{p("finish")};return(r,o)=>(l(),v("div",ts,[os,as,e("div",ls,[s.preregistrations.length===1?(l(),v("p",ns," Seu protocolo: ")):y("",!0),s.preregistrations.length>1?(l(),v("p",rs," Seus protocolos: ")):y("",!0),(l(!0),v(Z,null,Q(s.preregistrations,$=>(l(),v("div",{key:$.id,class:"mt-4"},[h(De,{bordered:"",class:"protocol m-auto"},{default:B(()=>[h(Oe,null,{default:B(()=>[$.type==="WAITING_LIST"?(l(),v("div",is,us)):(l(),v("div",cs,ps)),e("div",vs,[e("img",{src:c(C).logo,alt:c(C).entity.city,height:"90"},null,8,fs)]),e("dl",_s,[bs,e("dd",hs,"#"+b($.protocol),1),s.process.showPriorityProtocol?(l(),k(Qe,{key:0,preregistration:$},null,8,["preregistration"])):y("",!0),Es,e("dd",null,b(c(I).formatDateTime($.date)),1),ys,e("dd",null,b(s.student.student_name),1),gs,e("dd",null,b(V(s.student.grade))+" / "+b(D(s.student.period)),1),xs,e("dd",null,[e("p",$s,b($.school.name),1),$.school.phone?(l(),v("p",Ts," Telefone: "+b(`(${$.school.area_code}) ${$.school.phone}`),1)):y("",!0)])]),e("div",Ss,[ws,Cs,e("span",Rs,b($.code),1)])]),_:2},1024)]),_:2},1024)]))),128))]),e("div",{class:"mt-5 text-center",innerHTML:c(x).messageFooter},null,8,ks),e("div",Is,[e("div",As,[e("div",Ps,[h(P,{color:"primary",outline:"",label:"Imprimir",class:"w-100 mb-2",size:"lg","no-caps":"","no-wrap":"",onClick:L})]),e("div",Ns,[h(P,{color:"primary",outline:"",label:"Enviar por e-mail",class:"w-100",size:"lg","no-caps":"","no-wrap":"",onClick:_})])]),e("div",Vs,[e("div",Ls,[h(P,{color:"primary",label:"Nova Inscri\xE7\xE3o",outline:"",class:"w-100",size:"lg","no-caps":"","no-wrap":"",onClick:n})]),e("div",Os,[h(P,{color:"primary",label:"Voltar para a tela inicial",class:"w-100 border-primary",size:"lg","no-caps":"","no-wrap":"",onClick:o[0]||(o[0]=$=>r.$router.push("/"))})])])]),h(se,{modelValue:f.value.email,"onUpdate:modelValue":o[1]||(o[1]=$=>f.value.email=$),title:"Enviar protocolo(s) por e-mail","no-footer":""},{body:B(()=>[Ds,h(be,{schema:c(F),loading:c(E),onSubmit:d},null,8,["schema","loading"])]),_:1},8,["modelValue"])]))}});var Ms=Be(Fs,[["__scopeId","data-v-b6ca2bf4"]]);const Us=e("h2",{class:"font-muli-20-primary mb-4"}," Identifique o(a) aluno(a) para continuar com a inscri\xE7\xE3o: ",-1),Bs=e("p",null,[O(" Preencha os dados abaixo para identificar o(a) "),e("strong",null,"aluno(a)"),O(" que ser\xE1 rematriculado(a). ")],-1),zs={key:0,class:"row mt-5"},Hs=O(" Confirme se as iniciais do nome e a data de nascimento do(a) aluno(a) est\xE3o corretas: "),qs={key:0,class:"mt-4"},Gs={class:"row"},js={class:"col"},Ws=e("dt",{class:"font-hind font-size-10"}," Iniciais ",-1),Xs={class:"col"},Ys=e("dt",{class:"font-hind font-size-10"}," Data de nascimento ",-1),Js={class:"row"},Ks={class:"col-6"},Zs={class:"col-6"},Qs=z({__name:"RegistrationMatch",props:{student:null,registrationType:null,errors:null},emits:["next"],setup(s){const p=s,a=te("$filters"),I=g(!1),w=g(!1),E=oe(p,"student"),C=()=>{w.value=!1};return he(E,(N,f)=>{N.match!==f.match?w.value=!0:(w.value=!1,I.value=!0)},{deep:!0}),(N,f)=>(l(),v("div",null,[Us,Bs,s.registrationType?(l(),v("div",zs,[s.registrationType==="NAME_DATE_OF_BIRTH"?(l(),k(M,{key:0,modelValue:c(E).student_name,"onUpdate:modelValue":f[0]||(f[0]=x=>c(E).student_name=x),"container-class":"col-12 col-md-6",label:"Nome do(a) aluno(a)",name:"student_name",rules:"required",type:"TEXT",errors:!!s.errors.student_name},null,8,["modelValue","errors"])):y("",!0),s.registrationType==="NAME_DATE_OF_BIRTH"?(l(),k(M,{key:1,modelValue:c(E).student_date_of_birth,"onUpdate:modelValue":f[1]||(f[1]=x=>c(E).student_date_of_birth=x),"container-class":"col-12 col-md-6",label:"Data de nascimento do(a) aluno(a)",name:"student_date_of_birth",rules:"required|date",type:"DATE",errors:!!s.errors.student_date_of_birth},null,8,["modelValue","errors"])):y("",!0),s.registrationType==="CPF"?(l(),k(M,{key:2,modelValue:c(E).student_cpf,"onUpdate:modelValue":f[2]||(f[2]=x=>c(E).student_cpf=x),"container-class":"col-12 col-md-6 offset-md-3",label:"CPF do(a) aluno(a)",name:"student_cpf",rules:"required|cpf",type:"CPF",errors:!!s.errors.student_cpf},null,8,["modelValue","errors"])):y("",!0),s.registrationType==="RG"?(l(),k(M,{key:3,modelValue:c(E).student_rg,"onUpdate:modelValue":f[3]||(f[3]=x=>c(E).student_rg=x),"container-class":"col-12 col-md-6 offset-md-3",label:"RG do(a) aluno(a)",name:"student_rg",rules:"required|rg",type:"RG",errors:!!s.errors.student_rg},null,8,["modelValue","errors"])):y("",!0),s.registrationType==="BIRTH_CERTIFICATE"?(l(),k(M,{key:4,modelValue:c(E).student_birth_certificate,"onUpdate:modelValue":f[4]||(f[4]=x=>c(E).student_birth_certificate=x),"container-class":"col-12 col-md-8 offset-md-2",label:"Certid\xE3o de Nascimento do(a) aluno(a)",name:"student_birth_certificate",rules:"required",type:"BIRTH_CERTIFICATE",errors:!!s.errors.student_birth_certificate},null,8,["modelValue","errors"])):y("",!0)])):y("",!0),h(se,{modelValue:w.value,"onUpdate:modelValue":f[6]||(f[6]=x=>w.value=x),"icon-left":"status-green",title:"Aluno(a) Encontrado(a)","no-footer":""},{body:B(()=>[Hs,c(E).match?(l(),v("div",qs,[e("div",Gs,[e("dl",js,[Ws,e("dd",null,b(c(E).match.initials),1)]),e("dl",Xs,[Ys,e("dd",null,b(c(a).formatDate(c(E).match.dateOfBirth)),1)])])])):y("",!0),e("div",Js,[e("div",Ks,[h(P,{label:"N\xE3o s\xE3o estas",color:"gray-500",outline:"",class:"w-100","no-caps":"","no-wrap":"",onClick:C})]),e("div",Zs,[h(P,{label:"Est\xE3o corretas",color:"primary",class:"border-primary w-100","no-caps":"","no-wrap":"",onClick:f[5]||(f[5]=x=>N.$emit("next"))})])])]),_:1},8,["modelValue"])]))}}),et=e("h2",{class:"font-muli-20-primary mb-4"}," Identifique o(a) aluno(a) para continuar com a inscri\xE7\xE3o: ",-1),st=e("p",null,[O(" Selecione uma das op\xE7\xF5es abaixo para validar se o(a) "),e("strong",null,"aluno(a)"),O(" j\xE1 est\xE1 vinculado a rede municipal de ensino. Caso n\xE3o seja poss\xEDvel identific\xE1-lo com a op\xE7\xE3o selecionada, voc\xEA pode escolher outro campo para validar a exist\xEAncia dos dados. A solicita\xE7\xE3o de "),e("strong",null,"rematr\xEDcula"),O(" poder\xE1 ser efetuada somente para "),e("strong",null,"alunos(as) que estudaram no ano anterior na rede municipal"),O(". ")],-1),tt={class:"mt-5"},ot=z({__name:"RegistrationPreMatch",props:{modelValue:null,errors:null,rules:null},setup(s){const p=s,a=g([{key:"CPF",label:"CPF do(a) aluno(a)"},{key:"RG",label:"RG do(a) aluno(a)"},{key:"BIRTH_CERTIFICATE",label:"Certid\xE3o de nascimento do(a) aluno(a)"},{key:"NAME_DATE_OF_BIRTH",label:"Nome e data de nascimento do(a) aluno(a)"}]),I=oe(p,"modelValue");return(w,E)=>(l(),v("div",null,[et,st,e("div",tt,[h(M,{modelValue:c(I),"onUpdate:modelValue":E[0]||(E[0]=C=>Ee(I)?I.value=C:null),"container-class":"col-12 m-0 p-0 registration_custom",name:"type",rules:s.rules,type:"PRETTY_RADIO",options:a.value,errors:!!s.errors.type},null,8,["modelValue","rules","options","errors"])])]))}}),at={class:"container-pmd"},lt=e("h2",{class:"font-muli-20-primary mb-4"}," Confira seus dados antes de finalizar a inscri\xE7\xE3o: ",-1),nt={class:"mb-3 d-sm-flex justify-content-between"},rt=e("h3",{class:"font-hind-18-primary"}," Dados do(a) respons\xE1vel pelo(a) aluno(a) ",-1),it={class:"row"},dt={class:"font-hind font-size-10"},ut={key:0},ct={key:1},mt={class:"col-6"},pt=e("dt",{class:"font-hind font-size-10"}," Rela\xE7\xE3o com o(a) aluno(a) ",-1),vt={class:"col-sm-12"},ft=e("dt",{class:"font-hind font-size-10"}," Endere\xE7o ",-1),_t={key:0,class:"col-sm-12"},bt=e("dt",{class:"font-hind font-size-10"}," Endere\xE7o secund\xE1rio ",-1),ht={class:"mt-5 mb-3 d-sm-flex justify-content-between"},Et=e("h3",{class:"font-hind-18-primary"}," Dados do(a) aluno(a) ",-1),yt={class:"row"},gt={class:"font-hind font-size-10"},xt={key:0},$t={key:1},Tt={class:"mt-5 mb-3 d-sm-flex justify-content-between"},St=e("h3",{class:"font-hind-18-primary"}," Dados da pr\xE9-matr\xEDcula ",-1),wt={class:"row"},Ct={class:"col-6"},Rt=e("dt",{class:"font-hind font-size-10"}," S\xE9rie ",-1),kt={class:"col-6"},It=e("dt",{class:"font-hind font-size-10"}," Turno ",-1),At={key:0,class:"col-sm-12"},Pt=e("dt",{class:"font-hind font-size-10"}," Escola ",-1),Nt={key:1,class:"col-sm-12"},Vt=e("dt",{class:"font-hind font-size-10"}," Escola (lista de espera) ",-1),Lt={class:"row"},Ot=z({__name:"Review",props:{errors:null,fields:{default:()=>({})},responsible:{default:()=>({})},student:{default:()=>({})},process:{default:()=>({})}},emits:["edit-student","edit-responsible"],setup(s){const p=s,a=te("$filters"),I=ee(),w=g(!1),E=q(()=>I.getCities),C=q(()=>a.joinAddress(p.responsible.address)),N=q(()=>a.joinAddress(p.responsible.secondAddress)),f=_=>{var d;return(d=I.relationTypes.find(n=>n.key===_))==null?void 0:d.label},x=_=>{var d;return(d=p.process.grades.find(n=>Number(n.id)===Number(_)))==null?void 0:d.name},F=_=>{var d;return(d=p.process.periods.find(n=>Number(n.id)===Number(_)))==null?void 0:d.name},V=_=>{var d;return(d=p.process.schools.find(n=>Number(n.id)===Number(_)))==null?void 0:d.name},D=(_,d)=>{var n;return _[d.key]?(n=E.value.find(r=>r.key==_[d.key]))==null?void 0:n.label:"-"},L=(_,d)=>d.filter(_[d.key]);return(_,d)=>(l(),v("div",at,[lt,e("div",nt,[rt,h(P,{"data-test":"btn-edit-responsible",color:"primary",outline:"",class:"flex-row",label:"Editar dados","no-caps":"","no-wrap":"",onClick:d[0]||(d[0]=n=>_.$emit("edit-responsible"))})]),e("div",it,[(l(!0),v(Z,null,Q(s.fields.responsible,n=>(l(),v("dl",{key:n.id,class:"col-6"},[e("dt",dt,b(n.field.name),1),n.type!=="CITY"?(l(),v("dd",ut,b(L(s.responsible,n)),1)):(l(),v("dd",ct,b(D(s.responsible,n)),1))]))),128)),e("dl",mt,[pt,e("dd",null,b(f(s.responsible.relationType)),1)]),e("dl",vt,[ft,e("dd",null,b(c(C)),1)]),s.responsible.secondAddress&&s.responsible.secondAddress.postalCode?(l(),v("dl",_t,[bt,e("dd",null,b(c(N)),1)])):y("",!0)]),e("div",ht,[Et,h(P,{"data-test":"btn-edit-student",color:"primary",outline:"",class:"flex-row",label:"Editar dados","no-caps":"","no-wrap":"",onClick:d[1]||(d[1]=n=>_.$emit("edit-student"))})]),e("div",yt,[(l(!0),v(Z,null,Q(s.fields.student,n=>(l(),v("dl",{key:n.id,class:"col-6"},[e("dt",gt,b(n.field.name),1),n.type!=="CITY"?(l(),v("dd",xt,b(L(s.student,n)),1)):(l(),v("dd",$t,b(D(s.student,n)),1))]))),128))]),e("div",Tt,[St,h(P,{"data-test":"btn-edit-student-2",color:"primary",outline:"",class:"flex-row",label:"Editar dados","no-caps":"","no-wrap":"",onClick:d[2]||(d[2]=n=>_.$emit("edit-student"))})]),e("div",wt,[e("dl",Ct,[Rt,e("dd",null,b(x(s.student.grade)),1)]),e("dl",kt,[It,e("dd",null,b(F(s.student.period)),1)]),s.student.school?(l(),v("dl",At,[Pt,e("dd",null,b(V(s.student.school)),1)])):y("",!0),s.student.secondSchool?(l(),v("dl",Nt,[Vt,e("dd",null,b(V(s.student.secondSchool)),1)])):y("",!0)]),e("div",Lt,[h(M,{modelValue:w.value,"onUpdate:modelValue":d[3]||(d[3]=n=>w.value=n),label:`
        Eu autorizo o uso e tratamento dos dados pessoais acima para fins destinados a pr\xE9-matr\xEDcula na rede municipal
        `,"container-class":"col-12 col-md-8 offset-md-2 mt-4",rules:"required",errors:Boolean(s.errors.accept),name:"accept",type:"CHECKBOX"},null,8,["modelValue","errors"])])]))}}),Dt={class:"container",style:{"max-width":"740px"}},Ft=e("hr",{class:"mt-5"},null,-1),Mt=z({__name:"FormPreregistration",setup(s){return(p,a)=>(l(),v("div",Dt,[h(_e,{"quantity-button":0,"title-width":"70%"}),h(ve,{quantity:3}),Ft,h(_e,{"quantity-button":1,"title-width":"50%"}),h(fe),h(ve,{quantity:3}),h(fe,{class:"mt-3"})]))}}),Ut={class:"mt-5"},Bt={class:"col-12"},zt={key:5,class:"text-danger col-6 offset-3 text-center mt-5 alert alert-danger"},Ht={class:"row mt-4"},qt={class:"col-6 offset-3"},to=z({__name:"PreRegistration",setup(s){const{loader:p,data:a}=K(),{loader:I,loading:w}=K(),{loader:E}=Fe(),{pageview:C}=We(),N=Xe(),f=ee(),x=Ge(),F=je(),V=g(null),D=g(),L=g(),_=g(!1),d=g([]),n=g({responsible:[],student:[]}),r=g({}),o=g({}),$=g({}),W=g({}),i=g("LOADING"),ae=g({}),X=g(0),Y=g(!1),J=g(!1),ye=q(()=>({fields:[],buttons:[{type:"button",label:"Voltar",class:"btn btn-block btn-outline-light",containerClass:"offset-md-3 col-md-3",block:!0,action:$e},{type:"submit",label:"Prosseguir",class:"btn btn-block btn-primary",containerClass:"col-md-3 mt-3 mt-md-0",block:!0}],buttonsContainer:{class:"row mt-5"}}));he(i,m=>{m==="PRE_MATCH"||m==="MATCH"?C("/inscricao/dados-do-aluno"):m==="RESPONSIBLE"?C("/inscricao/dados-do-responsavel"):m==="STUDENT"?C("/inscricao/dados-do-aluno"):m==="REVIEW"?C("/inscricao/conferencia-de-dados"):m==="PROTOCOL"&&C("/inscricao/protocolo")});const ge=()=>{p(()=>Je({id:x.params.id})).then(m=>{if(m.status!=="OPEN"){F.push("/");return}a.value=m;const{fields:t,data:S}=Me(a.value.process),{fields:H,data:u}=Ue(a.value.process);if(n.value.responsible=t.sortBy("order"),r.value=S,n.value.student=H.sortBy("order"),o.value=u,!f.isProduction){const G=window.localStorage.getItem("responsible"),j=window.localStorage.getItem("student");G&&(r.value=R(R({},S),JSON.parse(G))),j&&(o.value=pe(R(R({},u),JSON.parse(j)),{useSecondSchool:!1}))}$.value=R({},S),W.value=R({},u),i.value=a.value.type==="REGISTRATION_RENEWAL"?"PRE_MATCH":"RESPONSIBLE"})},xe=()=>{var m;i.value=((m=a.value)==null?void 0:m.type)==="REGISTRATION_RENEWAL"?"PRE_MATCH":"RESPONSIBLE",ae.value=r.value,o.value=R({},W.value)},$e=()=>{i.value==="PRE_MATCH"?F.back():i.value==="MATCH"?i.value="PRE_MATCH":i.value==="RESPONSIBLE"?F.back():i.value==="STUDENT"?i.value="RESPONSIBLE":i.value==="REVIEW"&&(i.value="STUDENT"),window.scrollTo(0,0)},Te=async m=>{if(i.value==="PRE_MATCH")i.value="MATCH";else if(i.value==="MATCH")await U.submitMatch();else if(i.value==="RESPONSIBLE"){if(!m.address.lat&&!m.address.lng||m.address.lat===0&&m.address.lng===0)return;r.value=R(R({},r.value),m),U.saveOnStorage(),i.value="STUDENT"}else i.value==="STUDENT"?(o.value=R(R({},o.value),m),U.saveOnStorage(),U.submitToReview()):i.value==="REVIEW"&&await U.submit();window.scrollTo(0,0)},Se=async()=>{I(()=>Ke({type:V.value,student:o.value,year:a.value.process.schoolYear.year})).then(m=>{o.value.match=m,o.value.match===null&&(_.value=!0,D.value="Aluno(a) n\xE3o encontrado(a)",L.value="Verifique se os dados informados est\xE3o corretos. Caso n\xE3o encontre nenhum resultado, ",L.value+="clique em 'Voltar' e efetue a valida\xE7\xE3o com outro tipo de dado.")})},we=async()=>{var le,ne,re,ie,de;w.value=!0,_.value=!1;const{grade:m,period:t,school:S}=o.value,H=Object.keys(r.value).filter(T=>T.substring(0,6)==="field_"||T.substring(0,12)==="responsible_").map(T=>({field:T,value:r.value[T]?String(r.value[T]):null})),u=Object.keys(o.value).filter(T=>T.substring(0,6)==="field_"||T.substring(0,8)==="student_").map(T=>({field:T,value:o.value[T]?String(o.value[T]):null})),G=o.value.useSecondSchool||((le=a.value)==null?void 0:le.type)==="WAITING_LIST"?o.value.secondSchool:null,j=o.value.useSecondSchool||((ne=a.value)==null?void 0:ne.type)==="WAITING_LIST"?o.value.secondPeriod:null,Ie={process:(re=a.value)==null?void 0:re.process.id,stage:(ie=a.value)==null?void 0:ie.id,type:(de=a.value)==null?void 0:de.type,grade:m,period:t,school:S,optionalSchool:G,optionalPeriod:j||t,address:r.value.address,optionalAddress:r.value.useSecondAddress?r.value.secondAddress:null,relationType:r.value.relationType,responsible:H,student:u,externalPerson:o.value.match?o.value.match.id:null};E(()=>Ze(Ie)).then(T=>{d.value=T.preregistrations,i.value="PROTOCOL"}).catch(T=>{var ue;T.response.data.errors&&T.response.data.errors.length&&(_.value=!0,D.value=T.response.data.errors[0].message,L.value=(ue=T.response.data.errors[0].extensions)==null?void 0:ue.message)}).finally(()=>{w.value=!1})},Ce=()=>{var m,t;if(r.value.responsible_cpf&&o.value.student_cpf&&r.value.responsible_cpf===o.value.student_cpf&&r.value.relationType!=="SELF"){(t=((m=N.proxy)==null?void 0:m.$refs).form)==null||t.$refs.form.setErrors({student_cpf:"CPF igual ao do respons\xE1vel"});return}i.value="REVIEW"},Re=()=>{f.isProduction||setInterval(()=>{window.localStorage.setItem("responsible",JSON.stringify(r.value)),window.localStorage.setItem("student",JSON.stringify(o.value))},5e3)},ke=({changed:m,secondAddress:t})=>{r.value[t?"secondAddress":"address"].manualChangeLocation=m};qe(()=>ge());const U={submitMatch:Se,saveOnStorage:Re,submitToReview:Ce,submit:we};return U.saveOnStorage(),(m,t)=>(l(),v("div",Ut,[i.value==="LOADING"?(l(),k(Mt,{key:0})):y("",!0),i.value!=="LOADING"&&i.value!=="PROTOCOL"?(l(),k(be,{ref:"form",key:X.value+"-force-renderer","disable-proceed":Y.value||J.value,schema:c(ye),loading:c(w),"initial-values":ae.value,onSubmit:Te},{default:B(({errors:S,setFieldValue:H})=>[e("div",Bt,[i.value==="PRE_MATCH"?(l(),k(ot,{key:0,modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=u=>V.value=u),rules:"required",errors:S,class:"container-pmd"},null,8,["modelValue","errors"])):y("",!0),i.value==="MATCH"?(l(),k(Qs,{key:1,student:o.value,"onUpdate:student":t[1]||(t[1]=u=>o.value=u),"registration-type":V.value,errors:S,class:"container-pmd",onNext:t[2]||(t[2]=u=>i.value="RESPONSIBLE")},null,8,["student","registration-type","errors"])):y("",!0),i.value==="RESPONSIBLE"?(l(),k(es,{key:2,fields:n.value.responsible,"onUpdate:fields":t[3]||(t[3]=u=>n.value.responsible=u),responsible:r.value,"onUpdate:responsible":t[4]||(t[4]=u=>r.value=u),fetchingPrimaryAddressLatLng:Y.value,"onUpdate:fetchingPrimaryAddressLatLng":t[5]||(t[5]=u=>Y.value=u),fetchingSecondaryAddressLatLng:J.value,"onUpdate:fetchingSecondaryAddressLatLng":t[6]||(t[6]=u=>J.value=u),errors:S,"set-field-value":H,class:"container-pmd",onClean:t[7]||(t[7]=u=>(r.value=R({},$.value),X.value+=1))},null,8,["fields","responsible","fetchingPrimaryAddressLatLng","fetchingSecondaryAddressLatLng","errors","set-field-value"])):y("",!0),i.value==="STUDENT"?(l(),k(ss,{key:3,stage:c(a),"onUpdate:stage":t[8]||(t[8]=u=>Ee(a)?a.value=u:null),fields:n.value.student,"onUpdate:fields":t[9]||(t[9]=u=>n.value.student=u),student:o.value,"onUpdate:student":t[10]||(t[10]=u=>o.value=u),responsible:r.value,"onUpdate:responsible":t[11]||(t[11]=u=>r.value=u),errors:S,class:"container-pmd",onClean:t[12]||(t[12]=u=>(o.value=R({},W.value),X.value+=1)),onChangePrimaryAddress:ke},null,8,["stage","fields","student","responsible","errors"])):y("",!0),i.value==="REVIEW"?(l(),k(Ot,{key:4,process:c(a).process,fields:n.value,responsible:r.value,student:o.value,errors:S,onEditResponsible:t[13]||(t[13]=u=>i.value="RESPONSIBLE"),onEditStudent:t[14]||(t[14]=u=>i.value="STUDENT")},null,8,["process","fields","responsible","student","errors"])):y("",!0),Object.keys(S).length>0?(l(),v("div",zt," Preencha todos os campos corretamente ")):y("",!0)])]),_:1},8,["disable-proceed","schema","loading","initial-values"])):y("",!0),c(a)&&i.value==="PROTOCOL"?(l(),k(Ms,{key:2,process:c(a).process,"onUpdate:process":t[15]||(t[15]=S=>c(a).process=S),preregistrations:d.value,responsible:r.value,student:o.value,onFinish:xe},null,8,["process","preregistrations","responsible","student"])):y("",!0),h(se,{modelValue:_.value,"onUpdate:modelValue":t[17]||(t[17]=S=>_.value=S),title:D.value,"icon-left":"status-red","title-class":"text-danger","no-footer":""},{body:B(()=>[e("span",null,b(L.value),1),e("div",Ht,[e("div",qt,[h(P,{class:"w-100",color:"primary",label:"Entendi","no-caps":"","no-wrap":"",onClick:t[16]||(t[16]=S=>_.value=!1)})])])]),_:1},8,["modelValue","title"])]))}});export{to as default};
